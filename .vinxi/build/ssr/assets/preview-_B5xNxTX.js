import{jsxs as r,jsx as e,Fragment as N}from"react/jsx-runtime";import{useSuspenseQuery as y,useMutation as b}from"@tanstack/react-query";import{Link as m}from"@tanstack/react-router";import{Separator as v}from"radix-ui";import{useEffect as w}from"react";import{toast as I}from"sonner";import{C}from"./company-logo-B5lxhvXb.js";import{C as k,L as _}from"./link-chain-ChxIEzv5.js";import{E as S,P as z,G as E,C as O,I as j,F as R}from"./globe-BUymkEPS.js";import{F as d,c as F,n as L,L as M}from"./ssr-Bxxdisao.js";import{u as q}from"./use-image-preview-D0S5Wc-4.js";import{c as D}from"./create-company-BgWo2uPN.js";import"drizzle-orm/pg-core";import"better-auth/react";import"better-auth/client/plugins";import"zustand";import"@tanstack/router-core";import"@tanstack/start-client-core";import"@tanstack/start-server-core";import"cmdk";import"clsx";import"tailwind-merge";import"@tanstack/react-query-devtools";import"valibot";import"drizzle-orm";import"nanoid";import"@tanstack/react-router-with-query";import"tiny-invariant";import"node:stream";import"isbot";import"react-dom/server";import"./company.schema-5gxzbh_J.js";import"decode-formdata";const P={remote:"À distance",hybrid:"Hybride",onsite:"Sur site",not_specified:"Non spécifié"},Q={facebook:e(R,{className:"size-5"}),instagram:e(j,{className:"size-5"}),linkedin:e(M,{className:"size-5"}),calendly:e(O,{className:"size-5"})},be=function(){const{preview:a,queryClient:p}=d.useRouteContext(),{data:g}=y(F),f=d.useNavigate(),{imagePreviews:i,readImage:o}=q(),{mutate:x,isPending:l}=b({mutationFn:L(D)});w(()=>{a.logo&&o({type:"logo",file:a.logo}),a.gallery&&a.gallery.forEach((s,t)=>{o({type:"gallery",file:s,index:t})})},[a.logo,a.gallery,o]);const c={facebook:a.social_media.facebook,instagram:a.social_media.instagram,linkedin:a.social_media.linkedin,calendly:a.social_media.calendly},u=Object.values(c).every(s=>s==="");function h(){const s=new FormData;for(const[t,n]of Object.entries(a))typeof n=="string"&&s.append(t,n);for(const t of a.categories)s.append("categories",t);if(a.logo&&s.append("logo",a.logo),a.gallery)for(const t of a.gallery)s.append("gallery",t);console.log(Object.fromEntries(s.entries())),x({data:s},{onSuccess:()=>{I.success("Entreprise créée avec succès"),p.invalidateQueries({queryKey:["user","companies"]}),f({to:"/compte/entreprises"})}})}return r("main",{className:"px-4 py-8 grid gap-4",children:[e(m,{to:"/compte/entreprises/create",className:"text-sm text-gray-500",children:"Retour"}),r("div",{className:"container flex justify-between gap-4 border border-gray-300 p-6 rounded-sm",children:[r("div",{className:"flex flex-col gap-2",children:[e(C,{url:i.logo,name:a.name,size:"lg"}),r("div",{className:"flex items-center gap-2",children:[e("h1",{className:"text-2xl font-bold",children:a.name}),e(k,{children:a.siret})]}),a.categories.length?e("ul",{className:"flex flex-wrap gap-2",children:a.categories?.map(s=>{const t=g.find(n=>n.id===s);return t?e("li",{className:"bg-gray-400 text-white px-2 py-1 rounded-sm text-xs",children:e("span",{className:"max-w-[30ch] truncate",children:t.name})},t.id):null})}):null]}),e("div",{className:"flex gap-2",children:e("button",{type:"button",className:"bg-gray-100 p-2 rounded-sm cursor-pointer h-min",children:e(_,{className:"size-5"})})})]}),r("div",{className:"container flex gap-2",children:[r("div",{className:"flex-1 flex flex-col justify-center gap-4 border border-gray-300 p-6 rounded-sm",children:[r("div",{className:"flex flex-col gap-2",children:[r("div",{className:"flex items-center gap-2",children:[e(S,{className:"size-5"}),e("p",{className:"text-xs text-gray-500",children:a.email||"Non renseigné"})]}),r("div",{className:"flex items-center gap-2",children:[e(z,{className:"size-5"}),e("p",{className:"text-xs text-gray-500",children:a.phone||"Non renseigné"})]}),r("div",{className:"flex items-center gap-2",children:[e(E,{className:"size-5"}),a.website?e("a",{href:a.website,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-gray-500",children:a.website}):e("span",{className:"text-xs text-gray-500",children:"Non renseigné"})]})]}),u?null:e("ul",{className:"flex gap-2",children:Object.entries(c).map(([s,t])=>e("li",{children:e("a",{href:t,target:"_blank",rel:"noopener noreferrer",children:Q[s]})},s))})]}),r("div",{className:"flex-1 border border-gray-300 p-6 rounded-sm flex flex-col gap-2",children:[r("p",{className:"text-sm text-gray-500",children:[e("span",{className:"font-bold",children:"Entrepreneur:"})," ",a.business_owner||"Non renseigné"]}),r("p",{className:"text-sm text-gray-500",children:[e("span",{className:"font-bold",children:"Zone géographique:"})," ",a.service_area||"Non renseigné"]}),r("p",{className:"text-sm text-gray-500",children:[e("span",{className:"font-bold",children:"Mode de travail:"})," ",P[a.work_mode??"not_specified"]]}),r("p",{className:"text-sm text-gray-500",children:[e("span",{className:"font-bold",children:"RQTH:"})," ",a.rqth?"Oui":"Non"]}),r("p",{className:"text-sm text-gray-500",children:[e("span",{className:"font-bold",children:"Sous domaine:"})," ",a.subdomain||"Non renseigné"]})]})]}),r("div",{className:"container border border-gray-300 p-6 rounded-sm grid gap-4",children:[r("div",{className:"flex flex-col gap-2",children:[e("h2",{className:"text-lg font-bold",children:"Description"}),e("p",{className:"text-sm text-gray-500 text-pretty",children:a.description||"Non renseigné"})]}),i.gallery.length?r(N,{children:[e(v.Root,{className:"h-px bg-gray-300 my-4"}),e("ul",{className:"flex flex-wrap gap-2",children:i.gallery.map((s,t)=>e("li",{children:e("img",{src:s,alt:a.name,className:"size-16 aspect-square rounded-sm"})},t))})]}):null]}),r("div",{className:"container flex justify-end gap-2",children:[e(m,{to:"/compte/entreprises/create",className:"bg-gray-800 text-white px-3 py-2 rounded-sm font-light text-xs",children:"Retour"}),e("button",{type:"submit",className:"bg-gray-800 text-white px-3 py-2 rounded-sm font-light text-xs",onClick:h,disabled:l,children:l?"Validation en cours...":"Valider"})]})]})};export{be as component};
