import{jsx as t,jsxs as r}from"react/jsx-runtime";import{useSuspenseQuery as u,useMutation as d}from"@tanstack/react-query";import{useRef as h}from"react";import{toast as l}from"sonner";import{T as f}from"./trash-BEra1ZVi.js";import{createServerFn as b}from"@tanstack/start-client-core";import{k as g,R as U,l as R,m as F,n as c}from"./ssr-Bxxdisao.js";import{d as w,C as k}from"./constantes-BPJ6_ssB.js";import"@tanstack/react-router";import"radix-ui";import"drizzle-orm/pg-core";import"better-auth/react";import"better-auth/client/plugins";import"zustand";import"@tanstack/router-core";import"@tanstack/start-server-core";import"cmdk";import"clsx";import"tailwind-merge";import"@tanstack/react-query-devtools";import"valibot";import"drizzle-orm";import"nanoid";import"@tanstack/react-router-with-query";import"tiny-invariant";import"node:stream";import"isbot";import"react-dom/server";const j=g("app_lib_api_admin_mutations_update-user-role_ts--updateUserRoleFn_createServerFn_handler","/_server"),q=b({method:"POST"}).validator(o=>o).handler(j),Q=g("app_lib_api_companies_mutations_update-company-status_ts--updateCompanyStatus_createServerFn_handler","/_server"),T=b({method:"POST"}).validator(o=>o).handler(Q),de=function(){const n=U.useRouteContext(),{data:x}=u(R()),{data:y}=u(F),{mutate:v}=d({mutationFn:c(T)}),{mutate:C}=d({mutationFn:c(w)}),{mutate:_,isPending:p}=d({mutationFn:c(q)}),s=h(""),S=h("");function i(e,a){S.current=e,v({data:{companyId:e,status:a}},{onSuccess:()=>{l.success("Company status updated"),n.queryClient.invalidateQueries({queryKey:["companies"]})}})}function N(e,a){C({data:{companyId:e,companySlug:a}},{onSuccess:()=>{l.success("Company deleted"),n.queryClient.invalidateQueries({queryKey:["companies"]})}})}function m(e,a){s.current=e,_({data:{userId:e,role:a}},{onSuccess:()=>{l.success("User role updated"),n.queryClient.invalidateQueries({queryKey:["users"]})}})}return t("main",{children:r("div",{className:"container px-4 py-6 grid gap-6",children:[t("h1",{className:"text-2xl font-bold mb-4",children:"Dashboard"}),r("div",{className:"grid gap-4",children:[t("h2",{className:"text-lg font-bold",children:"Companies"}),t("div",{className:"grid gap-4",children:x?.map(e=>r("div",{className:"bg-white shadow-md rounded-lg p-4 border border-gray-200",children:[t("h2",{className:"text-lg font-bold",children:e.name}),t("p",{className:"text-sm text-gray-500",children:k[e.status]}),r("div",{className:"flex gap-2",children:[t("button",{name:"action",value:"accept",type:"button",className:"bg-green-500 text-white px-4 py-2 rounded-md text-xs disabled:opacity-50 disabled:cursor-not-allowed",disabled:e.status==="active",onClick:()=>i(e.id,"active"),children:"Accepter"}),t("button",{name:"action",value:"reject",type:"button",className:"bg-red-500 text-white px-4 py-2 rounded-md text-xs disabled:opacity-50 disabled:cursor-not-allowed",disabled:e.status==="rejected",onClick:()=>i(e.id,"rejected"),children:"Rejeter"}),t("button",{type:"button",className:"bg-blue-500 text-white px-4 py-2 rounded-md text-xs disabled:opacity-50 disabled:cursor-not-allowed",disabled:e.status==="pending",onClick:()=>i(e.id,"pending"),children:"En attente"})]}),t("button",{type:"button",className:"text-xs text-gray-500 border px-2 py-1 rounded-sm hover:bg-gray-100 transition-colors",onClick:()=>N(e.id,e.slug),children:t(f,{})})]},e.id))})]}),r("div",{className:"grid gap-4",children:[t("h2",{className:"text-lg font-bold",children:"Users"}),t("div",{className:"grid gap-4",children:y?.map(e=>r("div",{className:"bg-white shadow-md rounded-lg p-4 border border-gray-200",children:[t("p",{children:e.name}),t("p",{children:e.email}),t("p",{children:e.role}),r("div",{className:"flex gap-2",children:[t("button",{type:"button",className:"text-xs text-gray-500 border px-2 py-1 rounded-sm hover:bg-gray-100 transition-colors",onClick:()=>m(e.id,"admin"),children:p&&s.current===e.id&&e.role==="user"?"Updating...":"Set as admin"}),t("button",{type:"button",className:"text-xs text-gray-500 border px-2 py-1 rounded-sm hover:bg-gray-100 transition-colors",onClick:()=>m(e.id,"user"),children:p&&s.current===e.id&&e.role==="admin"?"Updating...":"Set as user"})]})]},e.id))})]})]})})};export{de as component};
