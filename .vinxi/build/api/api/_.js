import{betterAuth as d}from"better-auth";import{drizzleAdapter as l}from"better-auth/adapters/drizzle";import{admin as u}from"better-auth/plugins";import{drizzle as p}from"drizzle-orm/postgres-js";import c from"postgres";import{config as m}from"dotenv";import{pgTable as a,timestamp as t,text as e,boolean as i,varchar as r}from"drizzle-orm/pg-core";import{reactStartCookies as _}from"better-auth/react-start";import{a as f}from"./assets/index-BGf5JDnY.js";import"@tanstack/start-server-core";m({path:".env"});const A=c(process.env.DATABASE_URL,{prepare:!1}),N=p({client:A}),n=a("user",{id:e("id").primaryKey(),name:r("first_name",{length:255}).notNull(),email:r("email",{length:255}).notNull().unique(),emailVerified:i("email_verified").notNull(),image:r("image",{length:255}),createdAt:t("created_at").notNull(),updatedAt:t("updated_at").notNull(),role:r("role",{length:255}).$type().default("user").notNull(),banned:i("banned"),banReason:e("ban_reason"),banExpires:t("ban_expires")}),h=a("session",{id:e("id").primaryKey(),expiresAt:t("expires_at").notNull(),token:e("token").notNull().unique(),createdAt:t("created_at").notNull(),updatedAt:t("updated_at").notNull(),ipAddress:e("ip_address"),userAgent:e("user_agent"),userId:e("user_id").notNull().references(()=>n.id,{onDelete:"cascade"}),impersonatedBy:e("impersonated_by")}),g=a("account",{id:e("id").primaryKey(),accountId:e("account_id").notNull(),providerId:e("provider_id").notNull(),userId:e("user_id").notNull().references(()=>n.id,{onDelete:"cascade"}),accessToken:e("access_token"),refreshToken:e("refresh_token"),idToken:e("id_token"),accessTokenExpiresAt:t("access_token_expires_at"),refreshTokenExpiresAt:t("refresh_token_expires_at"),scope:e("scope"),password:e("password"),createdAt:t("created_at").notNull(),updatedAt:t("updated_at").notNull()}),b=a("verification",{id:e("id").primaryKey(),identifier:e("identifier").notNull(),value:e("value").notNull(),expiresAt:t("expires_at").notNull(),createdAt:t("created_at"),updatedAt:t("updated_at")}),s=d({database:l(N,{provider:"pg",schema:{user:n,session:h,account:g,verification:b}}),session:{cookieCache:{enabled:!0,maxAge:5*60}},plugins:[u({adminRoles:["admin","superadmin"]}),_()],advanced:{generateId:!1},emailAndPassword:{enabled:!0}}),P=f("/api/auth/$")({GET:({request:o})=>s.handler(o),POST:({request:o})=>s.handler(o)});export{P as APIRoute};
