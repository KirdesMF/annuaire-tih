import{jsxs as t,jsx as r}from"react/jsx-runtime";import{useMutation as u}from"@tanstack/react-query";import{createFileRoute as g,lazyRouteComponent as h,redirect as b,useRouter as f,Link as x}from"@tanstack/react-router";import{L as m,I as p}from"./label-DSAYOjK5.js";import*as e from"valibot";import{a as w}from"./auth.server-DtTByMvE.js";import{createServerFn as v}from"@tanstack/start-client-core";import{c as _}from"./index-8Htcofqc.js";import{u as y}from"./cn-CR1u50KS.js";import"better-auth";import"better-auth/adapters/drizzle";import"better-auth/plugins";import"./auth-BsEI6_U5.js";import"drizzle-orm/pg-core";import"better-auth/react-start";import"resend";import"tiny-invariant";import"drizzle-orm/postgres-js";import"postgres";import"dotenv";import"@tanstack/router-core";import"clsx";import"tailwind-merge";const S=()=>Promise.resolve().then(()=>N),F=e.object({email:e.pipe(e.string(),e.email()),password:e.pipe(e.string(),e.minLength(8))}),C=_("app_routes_auth_login_tsx--loginFn_createServerFn_handler","/_server",(o,n)=>l.__executeServer(o,n)),l=v({method:"POST"}).validator(o=>e.parse(F,o)).handler(C,async({data:o})=>{console.log(o),await w.api.signInEmail({body:{email:o.email,password:o.password}})}),L=g("/(auth)/login")({component:h(S,"component",()=>L.ssr),beforeLoad:async({context:o})=>{if(o.user)throw b({to:"/compte/entreprises"})}});e.object({email:e.pipe(e.string(),e.email()),password:e.pipe(e.string(),e.minLength(8))});const j=function(){const n=f(),{mutate:c,isPending:s}=u({mutationFn:y(l)});async function d(i){i.preventDefault();const a=new FormData(i.target);c({data:{email:a.get("email"),password:a.get("password")}},{onSuccess:async()=>{n.navigate({to:"/compte/entreprises"})}})}return t("main",{className:"py-12",children:[r("h1",{className:"text-2xl font-bold text-center mb-6",children:"Connexion"}),t("div",{className:"max-w-lg mx-auto border border-gray-200 p-6 rounded-sm shadow-sm",children:[t("form",{className:"flex flex-col gap-6",onSubmit:d,children:[t(m,{children:["Email *",r(p,{type:"email",name:"email",placeholder:"Email"})]}),t(m,{children:["Password *",r(p,{type:"password",name:"password",placeholder:"Password"})]}),r("button",{type:"submit",className:"border border-blue-400 text-blue-400 hover:bg-blue-400 hover:text-white transition-colors p-2 rounded-sm font-medium text-sm",disabled:s,children:s?"Connexion en cours...":"Connexion"})]}),r(x,{className:"text-sm text-gray-500",to:"/forgot-password",children:"Mot de passe oubli√© ?"})]})]})},N=Object.freeze(Object.defineProperty({__proto__:null,component:j},Symbol.toStringTag,{value:"Module"}));export{j as component};
