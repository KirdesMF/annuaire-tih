import{a0 as g,B as h,q as j,r as o,j as e,L as t,t as d}from"./client-0TpWmm9u.js";import{u as b}from"./useSuspenseQuery-BxnlANRH.js";import{C as f}from"./company-logo-BIcO5KEX.js";import{P as y}from"./plus-Cg62IB_I.js";import{D as N,d as C,a as v,b as D,c as S,e as w}from"./dialog-DXHigXuk.js";import{d as I,C as R}from"./constantes-CBVEnfXd.js";import{R as q}from"./index-Dt2I4tfU.js";import"./close-BuE9jvDt.js";function E(){return e.jsx("article",{className:"border border-gray-300 p-5 rounded-sm",children:e.jsxs(t,{to:"/compte/entreprises/create",className:"text-sm border px-2 py-1 rounded-sm flex items-center gap-1.5 max-w-fit",children:[e.jsx(y,{className:"size-4"}),"Créer une entreprise"]})})}const U=function(){const a=g.useRouteContext(),n=b(h(a.user.id)),{mutate:c,isPending:x}=j({mutationFn:I}),[p,i]=o.useState(!1),[l,m]=o.useState(null);function u(s){s.preventDefault();const r=new FormData(s.target);c({data:{companyId:r.get("companyId"),companySlug:r.get("companySlug")}},{onSuccess:()=>{a.queryClient.invalidateQueries({queryKey:["user","companies"]}),a.queryClient.invalidateQueries({queryKey:["company",l]}),i(!1),d.success("Entreprise supprimée avec succès")},onError:()=>{d.error("Une erreur est survenue lors de la suppression de l'entreprise")}})}return n.data?.length?e.jsxs("div",{className:"container px-4 py-6",children:[e.jsxs("header",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Mes entreprises"}),e.jsx("p",{children:"Gérez vos entreprises et leurs informations."})]}),e.jsx("ul",{className:"flex flex-col gap-2 ",children:n.data?.map(s=>e.jsx("li",{children:e.jsxs("article",{className:"border border-gray-300 p-5 rounded-sm grid gap-4 shadow-2xs",children:[e.jsxs("header",{className:"flex items-baseline gap-2 justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(f,{name:s.name,url:s.logo?.secureUrl}),e.jsx("h2",{className:"text-lg font-bold leading-1",children:s.name}),e.jsx("p",{className:"text-xs text-orange-300",children:R[s.status]})]}),e.jsx("p",{className:"text-xs text-gray-500 border px-2 py-1 rounded-sm inline-flex gap-2 items-center hover:cursor-pointer ",children:s.siret})]}),e.jsxs("footer",{className:"flex items-center gap-2 justify-between",children:[e.jsx("ul",{className:"flex flex-wrap gap-2",children:s.categories.map(r=>e.jsx("li",{className:"bg-gray-100 px-2 py-1 rounded-sm text-xs flex items-center gap-2",children:r.category_name},r.category_id))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(t,{to:"/entreprises/$slug",params:{slug:s.slug},className:"text-xs px-2 py-1 rounded-sm border border-blue-400 text-blue-400",children:"Consulter"}),e.jsx(t,{to:"/compte/entreprises/$slug/edit/infos",params:{slug:s.slug},className:"text-xs px-2 py-1 rounded-sm border border-blue-400 text-blue-400",children:"Modifier"}),e.jsxs(N,{open:p&&l===s.id,onOpenChange:i,children:[e.jsx(C,{asChild:!0,children:e.jsx("button",{type:"button",className:"text-xs px-2 py-1 rounded-sm border border-red-400 text-red-400 hover:bg-red-400 hover:text-white transition-colors",onClick:()=>m(s.id),children:"Supprimer"})}),e.jsxs(v,{className:"grid gap-4",children:[e.jsx(D,{className:"text-lg font-bold",children:"Supprimer une entreprise"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(S,{className:"text-sm text-gray-500",children:["Valider la suppression de l'entreprise ",e.jsx("strong",{children:s.name})," ?"]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Cette action est irréversible. Toutes les données liées à cette entreprise seront perdues."})]}),e.jsxs("div",{className:"grid grid-flow-col gap-2 place-content-end",children:[e.jsx(w,{asChild:!0,children:e.jsx("button",{type:"button",className:"text-xs px-2 py-1 rounded-sm border border-gray-400 text-gray-400 hover:bg-gray-400 hover:text-white transition-colors",children:"Annuler"})}),e.jsxs("form",{onSubmit:u,children:[e.jsx("input",{type:"hidden",name:"companyId",value:s.id}),e.jsx("input",{type:"hidden",name:"companySlug",value:s.slug}),e.jsx("button",{type:"submit",className:"text-xs px-2 py-1 rounded-sm border border-red-400 text-red-400 hover:bg-red-400 hover:text-white transition-colors",children:x?"...":"Valider"})]})]})]})]})]})]})]})},s.id))}),n.data.length<3&&e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"my-6 h-px bg-gray-300"}),e.jsx(E,{})]})]}):e.jsx("div",{className:"container px-4 py-6",children:e.jsxs("div",{className:"flex flex-col items-center justify-center gap-4",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Vous n'avez encore d'entreprise référencée"}),e.jsx(t,{to:"/compte/entreprises/create",className:"text-sm border px-2 py-1 rounded-sm",children:"Créer une entreprise"})]})})};export{U as component};
