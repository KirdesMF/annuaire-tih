import{m,n as x,R as _,o as N,p as S,q as d,s as o,r as u,j as t,t as i}from"./client-0TpWmm9u.js";import{u as p}from"./useSuspenseQuery-BxnlANRH.js";import{T as f}from"./trash-CVkehG-l.js";import{d as R,C as U}from"./constantes-CBVEnfXd.js";const F=x("app_lib_api_admin_mutations_update-user-role_ts--updateUserRoleFn_createServerFn_handler","/_server"),w=m({method:"POST"}).handler(F),q=x("app_lib_api_companies_mutations_update-company-status_ts--updateCompanyStatus_createServerFn_handler","/_server"),k=m({method:"POST"}).handler(q),K=function(){const a=_.useRouteContext(),{data:h}=p(N()),{data:b}=p(S),{mutate:g}=d({mutationFn:o(k)}),{mutate:y}=d({mutationFn:o(R)}),{mutate:j,isPending:l}=d({mutationFn:o(w)}),n=u.useRef(""),v=u.useRef("");function r(e,s){v.current=e,g({data:{companyId:e,status:s}},{onSuccess:()=>{i.success("Company status updated"),a.queryClient.invalidateQueries({queryKey:["companies"]})}})}function C(e,s){y({data:{companyId:e,companySlug:s}},{onSuccess:()=>{i.success("Company deleted"),a.queryClient.invalidateQueries({queryKey:["companies"]})}})}function c(e,s){n.current=e,j({data:{userId:e,role:s}},{onSuccess:()=>{i.success("User role updated"),a.queryClient.invalidateQueries({queryKey:["users"]})}})}return t.jsx("main",{children:t.jsxs("div",{className:"container px-4 py-6 grid gap-6",children:[t.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Dashboard"}),t.jsxs("div",{className:"grid gap-4",children:[t.jsx("h2",{className:"text-lg font-bold",children:"Companies"}),t.jsx("div",{className:"grid gap-4",children:h?.map(e=>t.jsxs("div",{className:"bg-white shadow-md rounded-lg p-4 border border-gray-200",children:[t.jsx("h2",{className:"text-lg font-bold",children:e.name}),t.jsx("p",{className:"text-sm text-gray-500",children:U[e.status]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{name:"action",value:"accept",type:"button",className:"bg-green-500 text-white px-4 py-2 rounded-md text-xs disabled:opacity-50 disabled:cursor-not-allowed",disabled:e.status==="active",onClick:()=>r(e.id,"active"),children:"Accepter"}),t.jsx("button",{name:"action",value:"reject",type:"button",className:"bg-red-500 text-white px-4 py-2 rounded-md text-xs disabled:opacity-50 disabled:cursor-not-allowed",disabled:e.status==="rejected",onClick:()=>r(e.id,"rejected"),children:"Rejeter"}),t.jsx("button",{type:"button",className:"bg-blue-500 text-white px-4 py-2 rounded-md text-xs disabled:opacity-50 disabled:cursor-not-allowed",disabled:e.status==="pending",onClick:()=>r(e.id,"pending"),children:"En attente"})]}),t.jsx("button",{type:"button",className:"text-xs text-gray-500 border px-2 py-1 rounded-sm hover:bg-gray-100 transition-colors",onClick:()=>C(e.id,e.slug),children:t.jsx(f,{})})]},e.id))})]}),t.jsxs("div",{className:"grid gap-4",children:[t.jsx("h2",{className:"text-lg font-bold",children:"Users"}),t.jsx("div",{className:"grid gap-4",children:b?.map(e=>t.jsxs("div",{className:"bg-white shadow-md rounded-lg p-4 border border-gray-200",children:[t.jsx("p",{children:e.name}),t.jsx("p",{children:e.email}),t.jsx("p",{children:e.role}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{type:"button",className:"text-xs text-gray-500 border px-2 py-1 rounded-sm hover:bg-gray-100 transition-colors",onClick:()=>c(e.id,"admin"),children:l&&n.current===e.id&&e.role==="user"?"Updating...":"Set as admin"}),t.jsx("button",{type:"button",className:"text-xs text-gray-500 border px-2 py-1 rounded-sm hover:bg-gray-100 transition-colors",onClick:()=>c(e.id,"user"),children:l&&n.current===e.id&&e.role==="admin"?"Updating...":"Set as user"})]})]},e.id))})]})]})})};export{K as component};
