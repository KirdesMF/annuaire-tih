import{bd as e,at as s,t as a,aI as l,r,be as t,j as n,n as i,o,P as c,C as d,_ as m,aW as x,b9 as p,aG as u,M as h,bf as g}from"../nitro/nitro.mjs";import{p as f}from"./input-DBDjV_JP.mjs";import{l as j}from"./label-DH_rTUQU.mjs";import{e as y}from"./close--xrcrNXd.mjs";import{o as N}from"./company.schema-5gxzbh_J.mjs";import{e as b}from"./chevron-down-CM3ht1vz.mjs";import{d as w}from"../_/index2.mjs";import{i as v,r as _,o as k,e as z,h as C,n as E}from"./globe-BUymkEPS.mjs";import{l as V}from"./plus-BVAK8_Jr.mjs";import{c as S}from"./use-image-preview-D0S5Wc-4.mjs";import{_ as P}from"./create-company-BgWo2uPN.mjs";import"node:net";import"node:stream";import"node:events";import"node:process";import"node:buffer";import"node:timers";import"node:async_hooks";import"node:url";import"node:stream/web";import"node:crypto";const Me=function(){const D=e.useRouteContext(),I=e.useNavigate(),{data:q}=s(u),{mutate:B,isPending:M}=a({mutationFn:l(P)}),R=r.useRef(null),L=t((e=>e.preview)),$=t((e=>e.setPreview)),[F,A]=r.useState(new Set(null==L?void 0:L.categories)),[H,J]=r.useState(0),{imagePreviews:Q,readImage:U}=S();function h$1(e,s,a){var l;const r=null==(l=e.target.files)?void 0:l[0];r&&U({type:s,file:r,index:a})}return n.jsx("div",{className:"container px-4 py-6",children:n.jsxs("div",{className:"max-w-xl mx-auto",children:[n.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Référencez votre entreprise"}),n.jsxs("form",{className:"flex flex-col gap-3",ref:R,onSubmit:function(e){e.preventDefault();const s=new FormData(e.target);B({data:s},{onSuccess:()=>{D.queryClient.invalidateQueries({queryKey:["user","companies"]}),h.success("Entreprise créée avec succès"),I({to:"/compte/entreprises"})},onError:e=>{console.error(e),h.error(e.message)}})},children:[n.jsx("input",{type:"hidden",name:"user_id",value:D.user.id}),n.jsxs(j,{className:"flex flex-col gap-1",children:[n.jsx("span",{className:"text-xs font-medium",children:"Nom de l'entreprise *"}),n.jsx(f,{type:"text",name:"name",placeholder:"Ex: mon entreprise",className:"placeholder:text-xs",defaultValue:null==L?void 0:L.name})]}),n.jsxs(j,{className:"flex flex-col gap-1",children:[n.jsx("span",{className:"text-xs font-medium",children:"Siret *"}),n.jsx(f,{type:"text",name:"siret",placeholder:"Ex: 12345678901234",className:"placeholder:text-xs",defaultValue:null==L?void 0:L.siret})]}),n.jsxs(j,{className:"flex flex-col gap-1",children:[n.jsx("span",{className:"text-xs font-medium",children:"Catégories * (max. 3)"}),n.jsxs(i,{children:[n.jsxs(o,{className:"h-9 cursor-pointer border rounded-sm border-gray-300 px-2 py-1 text-xs flex items-center justify-between gap-2",children:[n.jsx("span",{className:"rounded-sm text-xs flex items-center gap-2 text-gray-400",children:"Ajouter une catégorie"}),n.jsx(b,{className:"size-5 text-gray-500"})]}),n.jsx(c,{children:n.jsx(d,{className:"bg-white w-(--radix-popper-anchor-width)",sideOffset:5,children:n.jsxs(m,{className:"border rounded-sm border-gray-300",children:[n.jsx(m.Input,{placeholder:"Rechercher une catégorie",className:"w-full h-10 px-2 outline-none placeholder:text-sm placeholder:font-light"}),n.jsx(m.Separator,{className:"h-px bg-gray-300"}),n.jsx(m.List,{className:"max-h-60 overflow-y-auto",children:q.map((e=>n.jsx(m.Item,{value:e.name,disabled:F.has(e.id),className:"cursor-pointer py-1.5 px-2 aria-selected:bg-gray-100 text-sm font-light aria-disabled:opacity-20",onSelect:()=>function(e){A((s=>s.size>=3?(h.error("Vous ne pouvez pas sélectionner plus de 3 catégories"),s):new Set(s).add(e)))}(e.id),children:e.name},e.id)))})]})})})]})]}),F.size?n.jsx("ul",{className:"flex flex-wrap gap-2",children:Array.from(F.values()).map(((e,s)=>{const a=q.find((s=>s.id===e));return a?n.jsxs("li",{className:"bg-gray-400 text-white px-2 py-1 rounded-sm text-xs flex items-center gap-2",children:[n.jsx("input",{type:"hidden",name:`categories[${s}]`,value:a.id}),n.jsx("span",{className:"max-w-[30ch] truncate",children:a.name}),n.jsx("button",{type:"button",className:"text-white inline-grid place-items-center cursor-pointer",onClick:()=>function(e){A((s=>{const a=new Set(s);return a.delete(e),a}))}(a.id),children:n.jsx(y,{className:"size-3 text-white"})})]},a.id):null}))}):null,n.jsx(x,{className:"h-px bg-gray-300 my-4"}),n.jsxs("div",{className:"grid gap-1",children:[n.jsxs(j,{className:"flex flex-col gap-1",children:[n.jsx("span",{className:"text-xs font-medium",children:"Description"}),n.jsx("textarea",{name:"description",className:"border rounded-sm p-2 border-gray-300 resize-none placeholder:text-xs",rows:4,placeholder:"Entrer une description de mon entreprise...",onChange:function(e){J(e.target.value.length)},defaultValue:null==L?void 0:L.description})]}),n.jsxs("span",{className:"text-xs text-gray-500 justify-self-end",children:[H,"/1500"]})]}),n.jsxs(j,{className:"flex flex-col gap-1",children:[n.jsx("span",{className:"text-xs font-medium",children:"Entrepreneur"}),n.jsx(f,{type:"text",name:"business_owner",placeholder:"Ex: Nom Prénom",className:"placeholder:text-xs",defaultValue:null==L?void 0:L.business_owner})]}),n.jsxs(j,{className:"flex flex-col gap-1",children:[n.jsx("span",{className:"text-xs font-medium",children:"Perimètre d'intervention"}),n.jsx(f,{type:"text",name:"service_area",placeholder:"Ex: Paris, Lyon, Marseille",className:"placeholder:text-xs",defaultValue:null==L?void 0:L.service_area})]}),n.jsxs(j,{className:"flex flex-col gap-1",children:[n.jsx("span",{className:"text-xs font-medium",children:"Sous-domaine"}),n.jsx(f,{type:"text",name:"subdomain",placeholder:"Ex: monentreprise",className:"placeholder:text-xs",defaultValue:null==L?void 0:L.subdomain})]}),n.jsxs(j,{className:"flex flex-col gap-1",children:[n.jsx("span",{className:"text-xs font-medium",children:"Email"}),n.jsxs("div",{className:"flex items-center gap-2 border rounded-sm border-gray-300 h-9 px-2 focus-within:border-gray-500",children:[n.jsx(v,{className:"size-5 text-gray-500"}),n.jsx("input",{type:"email",name:"email",placeholder:"Ex: contact@monentreprise.com",className:"placeholder:text-xs outline-none w-full",defaultValue:null==L?void 0:L.email})]})]}),n.jsxs(j,{className:"flex flex-col gap-1",children:[n.jsx("span",{className:"text-xs font-medium",children:"Numéro de téléphone"}),n.jsxs("div",{className:"flex items-center gap-2 border rounded-sm border-gray-300 h-9 px-2 focus-within:border-gray-500",children:[n.jsx(_,{className:"size-5 text-gray-500"}),n.jsx("input",{type:"tel",name:"phone",placeholder:"Ex: 06 06 06 06 06",className:"placeholder:text-xs outline-none w-full",defaultValue:null==L?void 0:L.phone})]})]}),n.jsxs(j,{className:"flex flex-col gap-1",children:[n.jsx("span",{className:"text-xs font-medium",children:"Site web"}),n.jsxs("div",{className:"flex items-center gap-2 border rounded-sm border-gray-300 h-9 px-2 focus-within:border-gray-500",children:[n.jsx(k,{className:"size-5 text-gray-500"}),n.jsx("input",{type:"text",name:"website",placeholder:"Ex: https://www.monentreprise.com",className:"placeholder:text-xs outline-none w-full",defaultValue:null==L?void 0:L.website})]})]}),n.jsx(x,{className:"h-px bg-gray-300 my-4"}),n.jsxs("fieldset",{className:"flex flex-col gap-4",children:[n.jsx("legend",{className:"text-xs font-medium mb-2",children:"Réseaux sociaux"}),n.jsxs(j,{children:[n.jsx("span",{className:"sr-only",children:"Linkedin"}),n.jsxs("div",{className:"flex items-center gap-2 border rounded-sm border-gray-300 h-9 px-2 focus-within:border-gray-500",children:[n.jsx(p,{className:"size-5 text-gray-500"}),n.jsx("input",{type:"text",name:"social_media.linkedin",placeholder:"Ex: https://www.linkedin.com/company/monentreprise",className:"placeholder:text-xs outline-none w-full",defaultValue:null==L?void 0:L.social_media.linkedin})]})]}),n.jsxs(j,{children:[n.jsx("span",{className:"sr-only",children:"Facebook"}),n.jsxs("div",{className:"flex items-center gap-2 border rounded-sm border-gray-300 h-9 px-2 focus-within:border-gray-500",children:[n.jsx(z,{className:"size-5 text-gray-500"}),n.jsx("input",{type:"text",name:"social_media.facebook",placeholder:"Ex: https://www.facebook.com/monentreprise",className:"placeholder:text-xs outline-none w-full",defaultValue:null==L?void 0:L.social_media.facebook})]})]}),n.jsxs(j,{children:[n.jsx("span",{className:"sr-only",children:"Instagram"}),n.jsxs("div",{className:"flex items-center gap-2 border rounded-sm border-gray-300 h-9 px-2 focus-within:border-gray-500",children:[n.jsx(C,{className:"size-5 text-gray-500"}),n.jsx("input",{type:"text",name:"social_media.instagram",placeholder:"Ex: https://www.instagram.com/monentreprise",className:"placeholder:text-xs outline-none w-full",defaultValue:null==L?void 0:L.social_media.instagram})]})]}),n.jsxs(j,{children:[n.jsx("span",{className:"sr-only",children:"Calendly"}),n.jsxs("div",{className:"flex items-center gap-2 border rounded-sm border-gray-300 h-9 px-2 focus-within:border-gray-500",children:[n.jsx(E,{className:"size-5 text-gray-500"}),n.jsx("input",{type:"text",name:"social_media.calendly",placeholder:"Ex: https://calendly.com/monentreprise",className:"placeholder:text-xs outline-none w-full",defaultValue:null==L?void 0:L.social_media.calendly})]})]})]}),n.jsx(x,{className:"h-px bg-gray-300 my-4"}),n.jsxs("div",{className:"grid gap-8",children:[n.jsxs("fieldset",{className:"flex gap-4",children:[n.jsx("legend",{className:"text-xs font-medium mb-2",children:"Mode de travail"}),n.jsxs(j,{className:"flex items-center gap-1",children:[n.jsx(f,{type:"radio",name:"work_mode",value:"not_specified",defaultChecked:"not_specified"===(null==L?void 0:L.work_mode)||!(null==L?void 0:L.work_mode),className:"size-4 accent-gray-600"}),n.jsx("span",{className:"text-xs",children:"Non spécifié"})]}),n.jsxs(j,{className:"flex items-center gap-1",children:[n.jsx(f,{type:"radio",name:"work_mode",value:"remote",defaultChecked:"remote"===(null==L?void 0:L.work_mode),className:"size-4 accent-gray-600"}),n.jsx("span",{className:"text-xs",children:"À distance"})]}),n.jsxs(j,{className:"flex items-center gap-1",children:[n.jsx(f,{type:"radio",name:"work_mode",value:"onsite",defaultChecked:"onsite"===(null==L?void 0:L.work_mode),className:"size-4 accent-gray-600"}),n.jsx("span",{className:"text-xs",children:"Sur site"})]}),n.jsxs(j,{className:"flex items-center gap-1",children:[n.jsx(f,{type:"radio",name:"work_mode",value:"hybrid",defaultChecked:"hybrid"===(null==L?void 0:L.work_mode),className:"size-4 accent-gray-600"}),n.jsx("span",{className:"text-xs",children:"Hybride"})]})]}),n.jsxs("fieldset",{className:"flex gap-2",children:[n.jsx("legend",{className:"text-xs font-medium mb-2",children:"RQTH"}),n.jsxs(j,{className:"flex items-center gap-1",children:[n.jsx(f,{type:"radio",name:"rqth",value:"true",defaultChecked:null==L?void 0:L.rqth,className:"size-4 accent-gray-600"}),n.jsx("span",{className:"text-xs",children:"Oui"})]}),n.jsxs(j,{className:"flex items-center gap-1",children:[n.jsx(f,{type:"radio",name:"rqth",value:"false",defaultChecked:!(null==L?void 0:L.rqth),className:"size-4 accent-gray-600"}),n.jsx("span",{className:"text-xs",children:"Non"})]})]})]}),n.jsx(x,{className:"h-px bg-gray-300 my-4"}),n.jsxs("fieldset",{className:"border rounded-sm border-gray-300 p-4",children:[n.jsx("legend",{className:"text-xs font-medium  bg-white px-2",children:"Images"}),n.jsxs("div",{className:"flex gap-2 justify-center",children:[n.jsxs(j,{className:"relative flex flex-col gap-1 outline-none group",children:[n.jsx("span",{className:"text-xs font-medium",children:"Logo (max. 3MB)"}),n.jsxs("div",{className:"w-35 h-40 bg-gray-100 border border-gray-300 rounded-sm grid place-items-center group-focus-within:border-gray-500",children:[Q.logo?n.jsx("img",{src:Q.logo,alt:"Logo",className:"w-full h-full object-cover"}):n.jsx(V,{className:"size-8 rounded-full bg-gray-400 p-1 text-white"}),n.jsx("input",{type:"file",className:"absolute inset-0 opacity-0",name:"logo",onChange:e=>h$1(e,"logo"),accept:"image/*"})]})]}),n.jsxs(j,{className:"relative flex flex-col gap-1 outline-none group",children:[n.jsx("span",{className:"text-xs font-medium",children:"Image 1 (max. 2MB)"}),n.jsxs("div",{className:"w-35 h-40 bg-gray-100 border border-gray-300 rounded-sm grid place-items-center group-focus-within:border-gray-500",children:[Q.gallery[0]?n.jsx("img",{src:Q.gallery[0],alt:"gallery 1",className:"w-full h-full object-cover"}):n.jsx(V,{className:"size-8 rounded-full bg-gray-400 p-1 text-white"}),n.jsx("input",{type:"file",className:"absolute inset-0 opacity-0",name:"gallery",onChange:e=>h$1(e,"gallery",0),accept:"image/*"})]})]}),n.jsxs(j,{className:"relative flex flex-col gap-1 outline-none group",children:[n.jsx("span",{className:"text-xs font-medium",children:"Image 2 (max. 2MB)"}),n.jsxs("div",{className:"w-35 h-40 bg-gray-100 border border-gray-300 rounded-sm grid place-items-center group-focus-within:border-gray-500",children:[Q.gallery[1]?n.jsx("img",{src:Q.gallery[1],alt:"gallery 2",className:"w-full h-full object-cover"}):n.jsx(V,{className:"size-8 rounded-full bg-gray-400 p-1 text-white"}),n.jsx("input",{type:"file",className:"absolute inset-0 opacity-0",name:"gallery",onChange:e=>h$1(e,"gallery",1),accept:"image/*"})]})]})]})]}),n.jsx(x,{className:"h-px bg-gray-300 my-4"}),n.jsxs("div",{className:"flex gap-2 justify-end",children:[n.jsx("button",{type:"button",className:"bg-gray-800 text-white px-3 py-2 rounded-sm font-light text-xs disabled:opacity-50",onClick:function(){const e=new FormData(R.current),s=w(e,{files:["logo","gallery"],arrays:["categories","gallery"],booleans:["rqth"]}),a=g(N,s,{abortPipeEarly:!0});a.success?($(a.output),I({to:"/compte/entreprises/create/preview"})):h.error(n.jsx("div",{children:a.issues.map(((e,s)=>n.jsx("p",{children:e.message},s)))}))},children:"Prévisualiser"}),n.jsx("button",{type:"submit",className:"bg-gray-800 text-white px-3 py-2 rounded-sm font-light text-xs",disabled:M,children:M?"Création en cours...":"Créer un compte"})]})]})]})})};export{Me as component};
//# sourceMappingURL=index-DgcGe5lC.mjs.map
