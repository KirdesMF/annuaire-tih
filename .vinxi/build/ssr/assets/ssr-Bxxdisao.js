import{RouterProvider as Se,useRouter as X,linkOptions as Pe,Link as w,createRootRouteWithContext as Ne,Outlet as Te,useLayoutEffect as Fe,HeadContent as Ie,ScriptOnce as Ee,Scripts as ke,createFileRoute as c,lazyRouteComponent as i,redirect as v,createRouter as Le}from"@tanstack/react-router";import{jsx as t,jsxs as a}from"react/jsx-runtime";import{queryOptions as $,useQuery as Ae,useMutation as ze,QueryClient as je}from"@tanstack/react-query";import{Popover as L,DropdownMenu as d,Avatar as T}from"radix-ui";import{pgTable as F,timestamp as g,text as u,boolean as D,varchar as m,jsonb as O,index as Oe}from"drizzle-orm/pg-core";import{createAuthClient as De}from"better-auth/react";import{adminClient as Me}from"better-auth/client/plugins";import{toast as Z,Toaster as Ve}from"sonner";import{create as V}from"zustand";import{isPlainObject as Qe,encode as He,isRedirect as M,isNotFound as Be}from"@tanstack/router-core";import{startSerializer as P,mergeHeaders as G,createServerFn as y}from"@tanstack/start-client-core";import{defineHandlerCallback as Ge,transformReadableStreamWithRouter as Ke,transformPipeableStreamWithRouter as Ue,getHeaders as We,getEvent as Je,createStartHandler as Ye}from"@tanstack/start-server-core";import{useState as ee,useEffect as Xe}from"react";import{Command as C}from"cmdk";import{clsx as Ze}from"clsx";import{twMerge as et}from"tailwind-merge";import{ReactQueryDevtools as tt}from"@tanstack/react-query-devtools";import*as o from"valibot";import{sql as rt}from"drizzle-orm";import{nanoid as ot}from"nanoid";import{routerWithQueryClient as nt}from"@tanstack/react-router-with-query";import st from"tiny-invariant";import{PassThrough as at}from"node:stream";import{isbot as K}from"isbot";import k from"react-dom/server";function U(e){return t(Se,{router:e.router})}const it=Ge(async({request:e,router:r,responseHeaders:n})=>{if(typeof k.renderToReadableStream=="function"){const s=await k.renderToReadableStream(t(U,{router:r}),{signal:e.signal});K(e.headers.get("User-Agent"))&&await s.allReady;const l=Ke(r,s);return new Response(l,{status:r.state.statusCode,headers:n})}if(typeof k.renderToPipeableStream=="function"){const s=new at;try{const f=k.renderToPipeableStream(t(U,{router:r}),{...K(e.headers.get("User-Agent"))?{onAllReady(){f.pipe(s)}}:{onShellReady(){f.pipe(s)}},onError:(_,p)=>{console.error("Error in renderToPipeableStream:",_,p)}})}catch(f){console.error("Error in renderToPipeableStream:",f)}const l=Ue(r,s);return new Response(l,{status:r.state.statusCode,headers:n})}throw new Error("No renderToReadableStream or renderToPipeableStream found in react-dom/server. Ensure you are using a version of react-dom that supports streaming.")}),ct=()=>({routes:{__root__:{filePath:"__root.tsx",children:["/","/_protected","/admin","/(auth)/forgot-password","/(auth)/login","/(auth)/reset-password","/(auth)/signup","/(public)/about","/(public)/contact","/(public)/faq","/(public)/partner","/(public)/sources","/(public)/categories/$slug","/(public)/entreprises/$slug"],preloads:["/_build/assets/client-Qi-wcFct.js","/_build/assets/client-0TpWmm9u.js"]},"/":{filePath:"index.tsx"},"/_protected":{filePath:"_protected/route.tsx",children:["/_protected/compte"]},"/admin":{filePath:"admin/route.tsx",children:["/admin/dashboard","/admin/"]},"/_protected/compte":{filePath:"_protected/compte/route.tsx",parent:"/_protected",children:["/_protected/compte/preferences","/_protected/compte/","/_protected/compte/entreprises/","/_protected/compte/entreprises/$slug/edit","/_protected/compte/entreprises/create/preview","/_protected/compte/entreprises/create/"]},"/(auth)/forgot-password":{filePath:"(auth)/forgot-password.tsx"},"/(auth)/login":{filePath:"(auth)/login.tsx"},"/(auth)/reset-password":{filePath:"(auth)/reset-password.tsx"},"/(auth)/signup":{filePath:"(auth)/signup.tsx"},"/(public)/about":{filePath:"(public)/about.tsx"},"/(public)/contact":{filePath:"(public)/contact.tsx"},"/(public)/faq":{filePath:"(public)/faq.tsx"},"/(public)/partner":{filePath:"(public)/partner.tsx"},"/(public)/sources":{filePath:"(public)/sources.tsx"},"/admin/dashboard":{filePath:"admin/dashboard.tsx",parent:"/admin"},"/admin/":{filePath:"admin/index.tsx",parent:"/admin"},"/(public)/categories/$slug":{filePath:"(public)/categories/$slug.tsx"},"/(public)/entreprises/$slug":{filePath:"(public)/entreprises/$slug.tsx"},"/_protected/compte/preferences":{filePath:"_protected/compte/preferences.tsx",parent:"/_protected/compte"},"/_protected/compte/":{filePath:"_protected/compte/index.tsx",parent:"/_protected/compte"},"/_protected/compte/entreprises/":{filePath:"_protected/compte/entreprises/index.tsx",parent:"/_protected/compte"},"/_protected/compte/entreprises/$slug/edit":{filePath:"_protected/compte/entreprises/$slug/edit/route.tsx",parent:"/_protected/compte",children:["/_protected/compte/entreprises/$slug/edit/infos","/_protected/compte/entreprises/$slug/edit/medias","/_protected/compte/entreprises/$slug/edit/preview","/_protected/compte/entreprises/$slug/edit/"]},"/_protected/compte/entreprises/create/preview":{filePath:"_protected/compte/entreprises/create/preview.tsx",parent:"/_protected/compte"},"/_protected/compte/entreprises/create/":{filePath:"_protected/compte/entreprises/create/index.tsx",parent:"/_protected/compte"},"/_protected/compte/entreprises/$slug/edit/infos":{filePath:"_protected/compte/entreprises/$slug/edit/infos.tsx",parent:"/_protected/compte/entreprises/$slug/edit"},"/_protected/compte/entreprises/$slug/edit/medias":{filePath:"_protected/compte/entreprises/$slug/edit/medias.tsx",parent:"/_protected/compte/entreprises/$slug/edit"},"/_protected/compte/entreprises/$slug/edit/preview":{filePath:"_protected/compte/entreprises/$slug/edit/preview.tsx",parent:"/_protected/compte/entreprises/$slug/edit"},"/_protected/compte/entreprises/$slug/edit/":{filePath:"_protected/compte/entreprises/$slug/edit/index.tsx",parent:"/_protected/compte/entreprises/$slug/edit"}}});function pt(e){return globalThis.MANIFEST[e]}function lt(){const e=ct(),r=e.routes.__root__=e.routes.__root__||{};r.assets=r.assets||[];let n="";const s=pt("client"),l=s.inputs[s.handler]?.output.path;return l||st(l,"Could not find client entry in vinxi manifest"),r.assets.push({tag:"script",attrs:{type:"module",suppressHydrationWarning:!0,async:!0},children:`${n}import("${l}")`}),e}function dt(){const e=lt();return{...e,routes:Object.fromEntries(Object.entries(e.routes).map(([r,n])=>{const{preloads:s,assets:l}=n;return[r,{preloads:s,assets:l}]}))}}async function ut(e,r,n){var s;const l=r[0];if(Qe(l)&&l.method){const p=l,S=p.data instanceof FormData?"formData":"payload",N=new Headers({...S==="payload"?{"content-type":"application/json",accept:"application/json"}:{},...p.headers instanceof Headers?Object.fromEntries(p.headers.entries()):p.headers});if(p.method==="GET"){const R=He({payload:P.stringify({data:p.data,context:p.context})});R&&(e.includes("?")?e+=`&${R}`:e+=`?${R}`)}e.includes("?")?e+="&createServerFn":e+="?createServerFn",p.response==="raw"&&(e+="&raw");const z=await n(e,{method:p.method,headers:N,signal:p.signal,...mt(p)}),j=await W(z);if((s=j.headers.get("content-type"))!=null&&s.includes("application/json")){const R=P.decode(await j.json());if(M(R)||Be(R)||R instanceof Error)throw R;return R}return j}const f=await W(await n(e,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(r)})),_=f.headers.get("content-type");return _&&_.includes("application/json")?P.decode(await f.json()):f.text()}function mt(e){return e.method==="POST"?e.data instanceof FormData?(e.data.set("__TSR_CONTEXT",P.stringify(e.context)),{body:e.data}):{body:P.stringify({data:e.data??null,context:e.context})}:{}}async function W(e){if(!e.ok){const r=e.headers.get("content-type");throw r&&r.includes("application/json")?P.decode(await e.json()):new Error(await e.text())}return e}function ht(e){return e.replace(/^\/|\/$/g,"")}const b=(e,r)=>{const n=`/${ht(r)}/${e}`;return Object.assign((...l)=>ut(n,l,async(f,_)=>{_.headers=G(We(),_.headers);const p=await $fetch.native(f,_),S=Je(),N=G(p.headers,S.___ssrRpcResponseHeaders);return S.___ssrRpcResponseHeaders=N,p}),{url:n,functionId:e})};function gt(e){return a("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",...e,children:[t("title",{children:"Linkedin"}),t("path",{fill:"currentColor",d:"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037c-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85c3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.06 2.06 0 0 1-2.063-2.065a2.064 2.064 0 1 1 2.063 2.065m1.782 13.019H3.555V9h3.564zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0z"})]})}function ft(e){return a("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",...e,children:[t("title",{children:"Logout"}),t("path",{fill:"currentColor",d:"M5.616 20q-.691 0-1.153-.462T4 18.384V5.616q0-.691.463-1.153T5.616 4h5.903q.214 0 .357.143t.143.357t-.143.357t-.357.143H5.616q-.231 0-.424.192T5 5.616v12.769q0 .23.192.423t.423.192h5.904q.214 0 .357.143t.143.357t-.143.357t-.357.143zm12.444-7.5H9.692q-.213 0-.356-.143T9.192 12t.143-.357t.357-.143h8.368l-1.971-1.971q-.141-.14-.15-.338q-.01-.199.15-.364q.159-.165.353-.168q.195-.003.36.162l2.614 2.613q.242.243.242.566t-.243.566l-2.613 2.613q-.146.146-.347.153t-.366-.159q-.16-.165-.157-.357t.162-.35z"})]})}function _t(e){return a("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",...e,children:[t("title",{children:"Settings account"}),t("path",{fill:"currentColor",d:"M14.654 21.846q-.529 0-.9-.37t-.37-.899v-5.923q0-.529.37-.9t.9-.37h5.923q.529 0 .899.37t.37.9v5.923q0 .529-.37.899t-.899.37zM11 17.386V21h-.098q-.348 0-.576-.229t-.29-.571l-.263-2.092q-.479-.145-1.036-.454q-.556-.31-.947-.664l-1.915.824q-.317.14-.644.03t-.504-.415L3.648 15.57q-.177-.305-.104-.638t.348-.546l1.672-1.25q-.045-.272-.073-.559q-.03-.288-.03-.559q0-.252.03-.53q.028-.278.073-.626l-1.672-1.25q-.275-.213-.338-.555t.113-.648l1.06-1.8q.177-.287.504-.406t.644.021l1.896.804q.448-.373.97-.673q.52-.3 1.013-.464l.283-2.092q.061-.342.318-.571T10.96 3h2.08q.349 0 .605.229q.257.229.319.571l.263 2.112q.575.202 1.016.463t.909.654l1.992-.804q.318-.14.645-.021t.503.406l1.06 1.819q.177.306.104.641q-.073.336-.348.544l-1.216.911q-.176.135-.362.133t-.346-.173t-.148-.38t.183-.347l1.225-.908l-.994-1.7l-2.552 1.07q-.454-.499-1.193-.935q-.74-.435-1.4-.577L13 4h-1.994l-.312 2.689q-.756.161-1.39.52q-.633.358-1.26.985L5.55 7.15l-.994 1.7l2.169 1.62q-.125.336-.175.73t-.05.82q0 .38.05.755t.156.73l-2.15 1.645l.994 1.7l2.475-1.05q.6.606 1.363.999t1.612.588m.973-7.887q-1.046 0-1.773.724T9.473 12q0 .467.16.89t.479.777q.16.183.366.206q.207.023.384-.136q.177-.154.181-.355t-.154-.347q-.208-.2-.312-.47T10.473 12q0-.625.438-1.063t1.062-.437q.289 0 .565.116q.276.117.476.324q.146.148.338.134q.192-.015.346-.191q.154-.177.134-.381t-.198-.364q-.311-.3-.753-.469t-.908-.169m5.643 8.962q-.625 0-1.197.191q-.571.191-1.057.56q-.287.22-.44.445t-.153.456q0 .136.106.242t.242.105h5.097q.105 0 .177-.095q.07-.097.07-.252q0-.231-.152-.456q-.153-.225-.44-.444q-.486-.37-1.057-.561t-1.196-.191m0-.846q.528 0 .899-.37q.37-.371.37-.9t-.37-.899t-.9-.37q-.528 0-.899.37q-.37.37-.37.9q0 .528.37.898t.9.37"})]})}function yt(e){return a("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",...e,children:[t("title",{children:"Entreprise"}),t("path",{fill:"currentColor",d:"M4.616 20q-.691 0-1.153-.462T3 18.384V8.616q0-.691.463-1.153T4.615 7H9V5.615q0-.69.463-1.153T10.616 4h2.769q.69 0 1.153.462T15 5.615V7h4.385q.69 0 1.152.463T21 8.616v9.769q0 .69-.463 1.153T19.385 20zm0-1h14.769q.23 0 .423-.192t.192-.424V8.616q0-.231-.192-.424T19.385 8H4.615q-.23 0-.423.192T4 8.616v9.769q0 .23.192.423t.423.192M10 7h4V5.615q0-.23-.192-.423T13.385 5h-2.77q-.23 0-.423.192T10 5.615zM4 19V8z"})]})}function bt(e){return a("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",...e,children:[t("title",{children:"Add"}),t("path",{fill:"currentColor",d:"M18 20v-3h-3v-2h3v-3h2v3h3v2h-3v3zM3 21q-.825 0-1.412-.587T1 19V5q0-.825.588-1.412T3 3h14q.825 0 1.413.588T19 5v5h-2V8H3v11h13v2z"})]})}function vt(e){return a("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",...e,children:[t("title",{children:"Dashboard"}),t("path",{fill:"currentColor",d:"M5.616 20q-.691 0-1.153-.462T4 18.384V5.616q0-.691.463-1.153T5.616 4h12.769q.69 0 1.153.463T20 5.616v12.769q0 .69-.462 1.153T18.384 20zm0-1H11.5V5H5.616q-.231 0-.424.192T5 5.616v12.769q0 .23.192.423t.423.192m6.885 0h5.885q.23 0 .423-.192t.192-.424V12h-6.5zm0-8H19V5.616q0-.231-.192-.424T18.384 5H12.5z"})]})}const Rt=["admin","user"],wt=e=>e?Rt.includes(e):!1,A=F("user",{id:u("id").primaryKey(),name:m("first_name",{length:255}).notNull(),email:m("email",{length:255}).notNull().unique(),emailVerified:D("email_verified").notNull(),image:m("image",{length:255}),createdAt:g("created_at").notNull(),updatedAt:g("updated_at").notNull(),role:m("role",{length:255}).$type().default("user").notNull(),banned:D("banned"),banReason:u("ban_reason"),banExpires:g("ban_expires")});F("session",{id:u("id").primaryKey(),expiresAt:g("expires_at").notNull(),token:u("token").notNull().unique(),createdAt:g("created_at").notNull(),updatedAt:g("updated_at").notNull(),ipAddress:u("ip_address"),userAgent:u("user_agent"),userId:u("user_id").notNull().references(()=>A.id,{onDelete:"cascade"}),impersonatedBy:u("impersonated_by")});F("account",{id:u("id").primaryKey(),accountId:u("account_id").notNull(),providerId:u("provider_id").notNull(),userId:u("user_id").notNull().references(()=>A.id,{onDelete:"cascade"}),accessToken:u("access_token"),refreshToken:u("refresh_token"),idToken:u("id_token"),accessTokenExpiresAt:g("access_token_expires_at"),refreshTokenExpiresAt:g("refresh_token_expires_at"),scope:u("scope"),password:u("password"),createdAt:g("created_at").notNull(),updatedAt:g("updated_at").notNull()});F("verification",{id:u("id").primaryKey(),identifier:u("identifier").notNull(),value:u("value").notNull(),expiresAt:g("expires_at").notNull(),createdAt:g("created_at"),updatedAt:g("updated_at")});const $t=De({plugins:[Me()]});function Ct(){const{data:e}=$t.useSession(),r=e?.user.role;return{isAdmin:wt(r)&&(r==="admin"||r==="superadmin")}}function xt(e){const r=X();return async(...n)=>{try{const s=await e(...n);if(M(s))throw s;return s}catch(s){if(M(s)){const l=r.resolveRedirect({...s,_fromLocation:r.state.location});return r.navigate(l)}throw s}}}const te=V(e=>({theme:null,onThemeLight:()=>{localStorage.setItem("theme","light"),document.documentElement.dataset.theme="light",e({theme:"light"})},onThemeDark:()=>{localStorage.setItem("theme","dark"),document.documentElement.dataset.theme="dark",e({theme:"dark"})},onThemeSystem:()=>{localStorage.removeItem("theme"),document.documentElement.dataset.theme=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",e({theme:"system"})},setTheme:r=>e({theme:r})})),qt=b("app_lib_api_companies_queries_get-companies-by-term_ts--getCompaniesByTerm_createServerFn_handler","/_server"),St=y({method:"GET"}).validator(e=>e).handler(qt);function Pt(e){return $({queryKey:["companies",e],queryFn:({signal:r})=>St({data:e,signal:r}),enabled:e.length>=3})}function Nt(e,r){const[n,s]=ee(e);return Xe(()=>{const l=setTimeout(()=>s(e),r);return()=>clearTimeout(l)},[e,r]),n}function x(...e){return et(Ze(e))}const Tt=C;function Ft({className:e,...r}){return t(C.Loading,{className:x("px-4 py-2 text-sm",e),...r})}function It({className:e,ref:r,...n}){return t(C.Separator,{className:x("my-2 h-px w-full bg-gray-400",e),ref:r,...n})}function J({className:e,children:r,ref:n,...s}){return t(C.Empty,{className:x("px-4 py-2 text-sm",e),ref:n,...s,children:r})}function Et({className:e,...r}){return t(C.Input,{className:x(["w-full px-4 py-1.5 rounded-md outline-none text-sm","placeholder:text-sm"],e),...r})}function kt({className:e,ref:r,children:n,...s}){return t(C.List,{ref:r,className:x("max-h-80 scroll-py-8",e),...s,children:n})}function Lt({className:e,ref:r,children:n,...s}){return t(C.Item,{ref:r,className:x("px-4 py-2 text-sm w-full aria-selected:bg-gray-100 inline-flex",e),...s,children:n})}const At=L.Root,zt=L.Trigger;function jt({className:e,children:r,ref:n,...s}){return t(L.Portal,{children:t(L.Content,{ref:n,className:x("w-(--radix-popper-anchor-width) border border-gray-400 rounded-md shadow-sm bg-white",e),sideOffset:5,...s,children:r})})}const Ot=Pe([{label:"Qui sommes-nous ?",to:"/about"},{label:"FAQ",to:"/faq"},{label:"Sources",to:"/sources"},{label:"Contact",to:"/contact"}]),Dt=b("app_components_header_tsx--signOutFn_createServerFn_handler","/_server"),Mt=y({method:"POST"}).handler(Dt);function Vt({user:e,queryClient:r}){const[n,s]=ee(""),l=Nt(n,1e3),{data:f,isFetching:_}=Ae(Pt(l));return t("header",{className:"px-16 py-3 border-b border-gray-200 backdrop-blur-sm",children:a("div",{className:"flex items-center justify-between",children:[t("nav",{children:a("ul",{className:"flex items-center gap-4",children:[t("li",{children:t(w,{to:"/",className:"text-sm font-light",children:"Annuaire TIH"})}),Ot.map(p=>t("li",{children:t(w,{to:p.to,className:"text-sm font-light",activeProps:{className:"text-blue-700"},children:p.label})},p.to))]})}),a("div",{className:"flex items-center gap-4",children:[a(At,{children:[t(zt,{asChild:!0,children:t("button",{type:"button",className:"text-start text-xs text-nowrap font-light px-4 border border-gray-400 rounded-sm bg-white w-80 h-8 focus-within:outline focus-within:outline-blue-500",children:"Rechercher un nom ou une activité..."})}),t(jt,{children:a(Tt,{shouldFilter:!1,className:"py-2",children:[t(Et,{value:n,onValueChange:s,placeholder:"Entrez un nom ou une activité..."}),t(It,{alwaysRender:!0}),a(kt,{children:[!n&&t(J,{children:"Entrez au moins 3 caractères..."}),n&&_&&t(Ft,{children:"Loading..."}),n.length>=3&&!_&&t(J,{children:"Aucune entreprise trouvée"}),f?.map(p=>t(Lt,{asChild:!0,children:t(w,{to:"/entreprises/$slug",params:{slug:p.slug},children:p.name})},p.id))]})]})})]}),t("a",{href:"https://linkedin.com/groups/13011531",target:"_blank",rel:"noopener noreferrer",className:"hover:text-blue-700 transition-colors",children:t(gt,{className:"size-5"})}),t(Qt,{user:e}),t(Ht,{user:e}),t(Bt,{user:e,queryClient:r})]})]})})}function Qt({user:e}){return e?null:t(w,{to:"/signup",className:"text-xs px-2 py-1 rounded-sm border border-gray-400",children:"Se référencer"})}function Ht({user:e}){return e?null:t(w,{to:"/login",className:"text-xs px-2 py-1 rounded-sm border border-gray-400 cursor-pointer",children:"Login"})}function Bt({user:e,queryClient:r}){const n=X(),{theme:s,onThemeLight:l,onThemeDark:f,onThemeSystem:_,setTheme:p}=te(),{isAdmin:S}=Ct(),{mutate:N}=ze({mutationFn:xt(Mt)});if(!e)return null;async function z(){N(void 0,{onSuccess:()=>{r.clear(),Z.success("Vous êtes déconnecté"),n.invalidate(),n.navigate({to:"/"})}})}return a(d.Root,{children:[t(d.Trigger,{className:"rounded-full cursor-pointer",children:t(Gt,{user:e})}),t(d.Portal,{children:a(d.Content,{sideOffset:2,align:"end",className:"bg-white border rounded-sm border-gray-200 min-w-64 overflow-hidden p-1 shadow-xs dark:bg-gray-900 dark:border-gray-400",children:[a("div",{className:"flex flex-col p-2",children:[t("span",{className:"text-sm",children:e.name}),t("span",{className:"truncate text-xs",children:e.email})]}),t(d.Separator,{className:"h-px bg-gray-200 my-1 -mx-1"}),a(d.Group,{children:[t(d.Item,{asChild:!0,children:a(w,{to:"/compte/entreprises/create",className:"outline-none flex items-center gap-2 px-2 py-1.5 data-highlighted:bg-gray-100 select-none dark:data-highlighted:bg-gray-800",children:[t(bt,{className:"size-4"}),t("span",{className:"text-xs",children:"Référencer"})]})}),t(d.Item,{asChild:!0,children:a(w,{to:"/compte/entreprises",className:"outline-none flex items-center gap-2 px-2 py-1.5 data-highlighted:bg-gray-100 select-none dark:data-highlighted:bg-gray-800",children:[t(yt,{className:"size-4"}),t("span",{className:"text-xs",children:"Mes entreprises"})]})}),t(d.Item,{asChild:!0,children:a(w,{to:"/compte/preferences",className:"outline-none flex items-center gap-2 px-2 py-1.5 data-highlighted:bg-gray-100 select-none dark:data-highlighted:bg-gray-800",children:[t(_t,{className:"size-4"}),t("span",{className:"text-xs",children:"Mon compte"})]})}),S?t(d.Item,{asChild:!0,children:a(w,{to:"/admin/dashboard",className:"outline-none flex items-center gap-2 px-2 py-1.5 data-highlighted:bg-gray-100 select-none dark:data-highlighted:bg-gray-800",children:[t(vt,{className:"size-4"}),t("span",{className:"text-xs",children:"Admin dashboard"})]})}):null]}),t(d.Separator,{className:"h-px bg-gray-200 my-1 -mx-1"}),a(d.Group,{children:[t(d.Label,{className:"text-sm font-light px-2 py-1.5",children:"Thème"}),a(d.RadioGroup,{value:s??"system",onValueChange:p,children:[a(d.RadioItem,{value:"light",className:"text-xs py-1.5 ps-8 select-none outline-none data-highlighted:bg-gray-100 relative flex items-center dark:data-highlighted:bg-gray-800",onSelect:()=>l(),children:[t(d.ItemIndicator,{className:"absolute start-2",children:t("span",{className:"size-2 rounded-full flex bg-gray-400"})}),"Light"]}),a(d.RadioItem,{value:"dark",className:"text-xs py-1.5 ps-8 select-none outline-none data-highlighted:bg-gray-100 relative flex items-center dark:data-highlighted:bg-gray-800",onSelect:()=>f(),children:[t(d.ItemIndicator,{className:"absolute start-2",children:t("span",{className:"size-2 rounded-full flex bg-gray-400"})}),"Dark"]}),a(d.RadioItem,{value:"system",className:"text-xs py-1.5 ps-8 select-none outline-none data-highlighted:bg-gray-100 relative flex items-center dark:data-highlighted:bg-gray-800",onSelect:()=>_(),children:[t(d.ItemIndicator,{className:"absolute start-2",children:t("span",{className:"size-2 rounded-full flex bg-gray-400"})}),"System"]})]})]}),t(d.Separator,{className:"h-px bg-gray-200 my-1 -mx-1"}),t(d.Group,{children:a(d.Item,{onSelect:()=>z(),className:"text-xs px-2 py-1.5 outline-none cursor-pointer flex items-center gap-2 data-highlighted:bg-gray-100 dark:data-highlighted:bg-gray-800",children:[t(ft,{className:"size-4"}),t("span",{children:"Se déconnecter"})]})})]})})]})}function Gt({user:e}){if(!e)return null;const r=e.name?.split(" ").map(n=>n[0]).join("");return e.image?a(T.Root,{className:"size-8 rounded-full",children:[t(T.Image,{src:e.image,alt:e.name,className:"size-full rounded-full"}),t(T.Fallback,{className:"size-full leading-1",children:r})]}):t(T.Root,{className:"size-8 rounded-full border border-gray-200 flex",children:t(T.Fallback,{className:"size-full leading-1 text-xs grid place-items-center text-blue-500",children:r})})}const Kt="/_build/assets/app-h7mye6s-.css",Ut=b("app_routes_root_tsx--getSession_createServerFn_handler","/_server"),Wt=y({method:"GET"}).handler(Ut),Jt=$({queryKey:["user","session"],queryFn:({signal:e})=>Wt({signal:e})}),h=Ne()({head:()=>({meta:[{charSet:"utf-8"},{name:"viewport",content:"width=device-width, initial-scale=1"},{title:"Annuaire TIH"}],links:[{rel:"stylesheet",href:Kt}]}),beforeLoad:async({context:e})=>({user:(await e.queryClient.fetchQuery(Jt))?.user}),notFoundComponent:()=>t("div",{children:"Not found"}),component:Yt});function Yt(){return t(Xt,{children:t(Te,{})})}function Xt({children:e}){const{user:r,queryClient:n}=h.useRouteContext(),{setTheme:s}=te();return Fe(()=>{s(localStorage.getItem("theme")||"system")},[s]),a("html",{lang:"fr",suppressHydrationWarning:!0,children:[a("head",{children:[t(Ie,{}),t(Ee,{children:"document.documentElement.dataset.theme = localStorage.theme === 'dark' || (!('theme' in localStorage) && matchMedia('(prefers-color-scheme: dark)').matches) ? 'dark' : 'light'"})]}),a("body",{className:"font-sans text-gray-700 isolate dark:bg-gray-900 dark:text-gray-100",children:[t(Vt,{user:r,queryClient:n}),e,t(Ve,{}),t(tt,{buttonPosition:"bottom-left"}),t(ke,{})]})]})}const Zt=()=>import("./route-BCnNEv89.js"),re=c("/admin")({beforeLoad:({context:e})=>{if(!e.user)throw v({to:"/login"});const r=e.user.role;if(r!=="admin"&&r!=="superadmin")throw v({to:"/login"})},component:i(Zt,"component",()=>re.ssr)}),er=()=>import("./route-CjDoFr0g.js"),oe=c("/_protected")({component:i(er,"component",()=>oe.ssr),beforeLoad:async({context:e})=>{if(!e.user)throw v({to:"/login"});return{user:e.user}}}),tr=b("app_lib_api_categories_queries_get-categories_ts--getCategories_createServerFn_handler","/_server"),rr=y({method:"GET"}).handler(tr),I=$({queryKey:["categories"],queryFn:()=>rr(),staleTime:1e3*60*60*24}),or=()=>import("./index-DHOn5xHJ.js"),ne=c("/")({component:i(or,"component",()=>ne.ssr),loader:async({context:e})=>{await e.queryClient.ensureQueryData(I)}}),nr=c("/admin/")({beforeLoad:()=>{throw v({to:"/admin/dashboard"})}}),sr=["active","rejected","pending"],ar=o.object({status:o.optional(o.picklist(sr))}),ir=b("app_lib_api_companies_queries_get-companies_ts--getCompanies_createServerFn_handler","/_server"),cr=y({method:"GET"}).validator(e=>o.parse(ar,e)).handler(ir);function pr(e={}){return $({queryKey:["companies",e],queryFn:()=>cr({data:e})})}const lr=b("app_lib_api_users_queries_get-users_ts--getUsers_createServerFn_handler","/_server"),dr=y({method:"GET"}).handler(lr),ur=$({queryKey:["users"],queryFn:()=>dr()}),mr=()=>import("./dashboard-RW2G6P8z.js"),hr=()=>import("./dashboard-BSpQfuSc.js"),se=c("/admin/dashboard")({component:i(hr,"component",()=>se.ssr),pendingComponent:i(mr,"pendingComponent"),loader:async({context:e})=>{await Promise.all([e.queryClient.prefetchQuery(pr()),e.queryClient.prefetchQuery(ur)])}}),gr=()=>import("./sources-CPVzUGRn.js"),ae=c("/(public)/sources")({component:i(gr,"component",()=>ae.ssr)}),fr=()=>import("./partner-eGLwnrmV.js"),ie=c("/(public)/partner")({component:i(fr,"component",()=>ie.ssr)}),_r=()=>import("./faq-BE3u91NJ.js"),ce=c("/(public)/faq")({component:i(_r,"component",()=>ce.ssr)}),yr=()=>import("./contact-D_SEO6t2.js"),pe=c("/(public)/contact")({component:i(yr,"component",()=>pe.ssr)}),br=()=>import("./about-CzFvV-7i.js"),le=c("/(public)/about")({component:i(br,"component",()=>le.ssr)}),vr=()=>import("./signup-DJYU8Rya.js"),Rr=o.object({email:o.pipe(o.string(),o.nonEmpty("Veuillez entrer votre email"),o.email("Veuillez entrer un email valide")),password:o.pipe(o.string(),o.minLength(8,"Le mot de passe doit contenir au moins 8 caractères"),o.maxLength(100,"Le mot de passe doit contenir au plus 100 caractères")),firstName:o.pipe(o.string(),o.nonEmpty("Veuillez entrer votre prénom"),o.maxLength(100,"Le prénom doit contenir au plus 100 caractères")),lastName:o.pipe(o.string(),o.nonEmpty("Veuillez entrer votre nom"),o.maxLength(100,"Le nom doit contenir au plus 100 caractères"))}),wr=b("app_routes_auth_signup_tsx--signupFn_createServerFn_handler","/_server"),dn=y().validator(e=>o.parse(Rr,e)).handler(wr),de=c("/(auth)/signup")({component:i(vr,"component",()=>de.ssr),beforeLoad:async({context:e})=>{if(e.user)throw v({to:"/compte/entreprises"})}}),$r=()=>import("./reset-password-lAyvbxNF.js"),Cr=o.object({token:o.string()}),ue=c("/(auth)/reset-password")({validateSearch:e=>o.parse(Cr,e),component:i($r,"component",()=>ue.ssr)}),xr=()=>import("./login-DJoz3h4z.js"),qr=o.object({email:o.pipe(o.string(),o.email()),password:o.pipe(o.string(),o.minLength(8))}),Sr=b("app_routes_auth_login_tsx--loginFn_createServerFn_handler","/_server"),un=y({method:"POST"}).validator(e=>o.parse(qr,e)).handler(Sr),me=c("/(auth)/login")({component:i(xr,"component",()=>me.ssr),beforeLoad:async({context:e})=>{if(e.user)throw v({to:"/compte/entreprises"})}}),Pr=()=>import("./forgot-password-CXXUF6vO.js"),Nr=o.object({email:o.pipe(o.string(),o.email("Veuillez entrer une adresse email valide"))}),Tr=b("app_routes_auth_forgot-password_tsx--forgotPasswordFn_createServerFn_handler","/_server"),mn=y({method:"POST"}).validator(e=>{const r=Object.fromEntries(e.entries());return o.parse(Nr,r)}).handler(Tr),he=c("/(auth)/forgot-password")({component:i(Pr,"component",()=>he.ssr)}),Fr=b("app_lib_api_users_queries_get-user-companies_ts--getUserCompanies_createServerFn_handler","/_server"),Ir=y({method:"GET"}).validator(e=>e).handler(Fr);function Q(e){return $({queryKey:["user","companies",e],queryFn:()=>Ir({data:e}),staleTime:1e3*60*60*24})}const Er=()=>import("./route-BrPbEBLK.js"),ge=c("/_protected/compte")({component:i(Er,"component",()=>ge.ssr),loader:async({context:e})=>{await e.queryClient.ensureQueryData(Q(e.user.id))}}),kr=c("/_protected/compte/")({beforeLoad:({location:e})=>{throw v({to:"/compte/entreprises"})}}),Lr=()=>import("./preferences-B98srASG.js"),fe=c("/_protected/compte/preferences")({component:i(Lr,"component",()=>fe.ssr)}),Ar=b("app_lib_api_companies_queries_get-company-by-slug_ts--getCompanyBySlug_createServerFn_handler","/_server"),zr=y({method:"GET"}).validator(e=>e).handler(Ar),H=e=>$({queryKey:["company",e],queryFn:()=>zr({data:e}),staleTime:1e3*60*60*24,refetchOnWindowFocus:!1}),jr=()=>import("./_slug-BD5xRgOT.js"),Or=()=>import("./_slug-RW2G6P8z.js"),Dr=()=>import("./_slug-BjpIK4lq.js"),_e=c("/(public)/entreprises/$slug")({component:i(Dr,"component",()=>_e.ssr),pendingComponent:i(Or,"pendingComponent"),errorComponent:i(jr,"errorComponent"),loader:async({context:e,params:r})=>{await e.queryClient.ensureQueryData(H(r.slug))}});F("companies",{id:u("id").primaryKey().$defaultFn(()=>ot(32)),status:m("status").$type().notNull().default("pending"),created_at:g("created_at").notNull().defaultNow(),updated_at:g("updated_at").notNull().defaultNow(),created_by:u("created_by").references(()=>A.id,{onDelete:"cascade"}).notNull(),user_id:u("user_id").references(()=>A.id,{onDelete:"cascade"}).notNull(),name:m("name",{length:255}).notNull(),slug:m("slug",{length:100}).notNull().unique(),siret:m("siret",{length:14}).notNull(),business_owner:m("business_owner",{length:255}),description:m("description",{length:1500}),website:m("website",{length:255}),location:m("location",{length:255}),service_area:m("service_area",{length:255}),subdomain:m("subdomain",{length:100}),work_mode:m("work_mode").$type(),email:m("email",{length:255}),phone:m("phone",{length:24}),rqth:D("rqth").notNull().default(!1),logo:O("logo").$type(),gallery:O("gallery").$type().notNull().default([]),social_media:O("social_media").$type().notNull().default({facebook:"",calendly:"",linkedin:"",instagram:""})},e=>[Oe("company_search_index").using("gin",rt`to_tsvector('french', ${e.name} || ' ' || ${e.subdomain} || ' ' || ${e.description})`)]);const Mr=["pending","active","rejected"],hn=["remote","hybrid","onsite","not_specified"],Vr=o.object({categoryId:o.string(),status:o.picklist(Mr)}),Qr=b("app_lib_api_companies_queries_get-companies-by-category_ts--getCompaniesByCategory_createServerFn_handler","/_server"),Hr=y({method:"GET"}).validator(e=>o.parse(Vr,e)).handler(Qr);function Br(e){return $({queryKey:["companies","category",e],queryFn:()=>Hr({data:e})})}const Gr=()=>import("./_slug-C0dQHW1P.js"),Kr=o.object({id:o.string()}),ye=c("/(public)/categories/$slug")({validateSearch:e=>o.parse(Kr,e),loaderDeps:({search:e})=>({categoryId:e.id}),loader:async({context:e,deps:{categoryId:r}})=>{await e.queryClient.ensureQueryData(Br({categoryId:r,status:"active"}))},component:i(Gr,"component",()=>ye.ssr)}),Ur=()=>import("./index-CvFRPJbz.js"),be=c("/_protected/compte/entreprises/")({loader:async({context:e})=>{await e.queryClient.ensureQueryData(Q(e.user.id))},component:i(Ur,"component",()=>be.ssr)}),Wr=()=>import("./index-DgcGe5lC.js"),ve=c("/_protected/compte/entreprises/create/")({component:i(Wr,"component",()=>ve.ssr),beforeLoad:async({context:e})=>{const r=await e.queryClient.ensureQueryData(Q(e.user.id));if(r&&r?.length>=3)throw Z.error("Vous ne pouvez pas créer plus de 3 entreprises"),v({to:"/compte/entreprises"})},loader:async({context:e})=>{await e.queryClient.ensureQueryData(I)}}),Jr=V(e=>({preview:null,setPreview:r=>e({preview:r})})),Yr=V(e=>({preview:null,setPreview:r=>e({preview:r})})),Xr=()=>import("./preview-_B5xNxTX.js"),Re=c("/_protected/compte/entreprises/create/preview")({component:i(Xr,"component",()=>Re.ssr),beforeLoad:()=>{const e=Jr.getState().preview;if(!e)throw v({to:"/compte/entreprises/create"});return{preview:e}},loader:async({context:e})=>{await e.queryClient.ensureQueryData(I)}}),Zr=()=>import("./route-CD4qJwfN.js"),we=c("/_protected/compte/entreprises/$slug/edit")({component:i(Zr,"component",()=>we.ssr)}),eo=c("/_protected/compte/entreprises/$slug/edit/")({beforeLoad:({location:e,params:r})=>{throw v({to:"/compte/entreprises/$slug/edit/infos",params:r})}}),to=()=>import("./preview-D2Nr7qlg.js"),$e=c("/_protected/compte/entreprises/$slug/edit/preview")({component:i(to,"component",()=>$e.ssr),beforeLoad:({params:e})=>{const r=Yr.getState().preview;if(!r)throw v({to:"/compte/entreprises/$slug/edit/infos",params:e});return{preview:r}},loader:async({context:e})=>{await e.queryClient.ensureQueryData(I)}}),ro=()=>import("./medias-aqHZ1XS7.js"),Ce=c("/_protected/compte/entreprises/$slug/edit/medias")({loader:async({context:e,params:r})=>{await e.queryClient.ensureQueryData(H(r.slug))},component:i(ro,"component",()=>Ce.ssr)}),oo=()=>import("./infos-C3pT2EqC.js"),no=()=>import("./infos-C1-hKJDH.js"),xe=c("/_protected/compte/entreprises/$slug/edit/infos")({loader:async({context:e,params:r})=>{await Promise.all([e.queryClient.ensureQueryData(H(r.slug)),e.queryClient.ensureQueryData(I)])},component:i(no,"component",()=>xe.ssr),errorComponent:i(oo,"errorComponent")}),B=re.update({id:"/admin",path:"/admin",getParentRoute:()=>h}),qe=oe.update({id:"/_protected",getParentRoute:()=>h}),so=ne.update({id:"/",path:"/",getParentRoute:()=>h}),ao=nr.update({id:"/",path:"/",getParentRoute:()=>B}),io=se.update({id:"/dashboard",path:"/dashboard",getParentRoute:()=>B}),co=ae.update({id:"/(public)/sources",path:"/sources",getParentRoute:()=>h}),po=ie.update({id:"/(public)/partner",path:"/partner",getParentRoute:()=>h}),lo=ce.update({id:"/(public)/faq",path:"/faq",getParentRoute:()=>h}),uo=pe.update({id:"/(public)/contact",path:"/contact",getParentRoute:()=>h}),mo=le.update({id:"/(public)/about",path:"/about",getParentRoute:()=>h}),ho=de.update({id:"/(auth)/signup",path:"/signup",getParentRoute:()=>h}),go=ue.update({id:"/(auth)/reset-password",path:"/reset-password",getParentRoute:()=>h}),fo=me.update({id:"/(auth)/login",path:"/login",getParentRoute:()=>h}),_o=he.update({id:"/(auth)/forgot-password",path:"/forgot-password",getParentRoute:()=>h}),q=ge.update({id:"/compte",path:"/compte",getParentRoute:()=>qe}),yo=kr.update({id:"/",path:"/",getParentRoute:()=>q}),bo=fe.update({id:"/preferences",path:"/preferences",getParentRoute:()=>q}),vo=_e.update({id:"/(public)/entreprises/$slug",path:"/entreprises/$slug",getParentRoute:()=>h}),Ro=ye.update({id:"/(public)/categories/$slug",path:"/categories/$slug",getParentRoute:()=>h}),wo=be.update({id:"/entreprises/",path:"/entreprises/",getParentRoute:()=>q}),$o=ve.update({id:"/entreprises/create/",path:"/entreprises/create/",getParentRoute:()=>q}),Co=Re.update({id:"/entreprises/create/preview",path:"/entreprises/create/preview",getParentRoute:()=>q}),E=we.update({id:"/entreprises/$slug/edit",path:"/entreprises/$slug/edit",getParentRoute:()=>q}),xo=eo.update({id:"/",path:"/",getParentRoute:()=>E}),qo=$e.update({id:"/preview",path:"/preview",getParentRoute:()=>E}),So=Ce.update({id:"/medias",path:"/medias",getParentRoute:()=>E}),Po=xe.update({id:"/infos",path:"/infos",getParentRoute:()=>E}),No={ProtectedCompteEntreprisesSlugEditInfosRoute:Po,ProtectedCompteEntreprisesSlugEditMediasRoute:So,ProtectedCompteEntreprisesSlugEditPreviewRoute:qo,ProtectedCompteEntreprisesSlugEditIndexRoute:xo},To=E._addFileChildren(No),Fo={ProtectedComptePreferencesRoute:bo,ProtectedCompteIndexRoute:yo,ProtectedCompteEntreprisesIndexRoute:wo,ProtectedCompteEntreprisesSlugEditRouteRoute:To,ProtectedCompteEntreprisesCreatePreviewRoute:Co,ProtectedCompteEntreprisesCreateIndexRoute:$o},Io=q._addFileChildren(Fo),Eo={ProtectedCompteRouteRoute:Io},ko=qe._addFileChildren(Eo),Lo={AdminDashboardRoute:io,AdminIndexRoute:ao},Ao=B._addFileChildren(Lo),zo={IndexRoute:so,ProtectedRouteRoute:ko,AdminRouteRoute:Ao,authForgotPasswordRoute:_o,authLoginRoute:fo,authResetPasswordRoute:go,authSignupRoute:ho,publicAboutRoute:mo,publicContactRoute:uo,publicFaqRoute:lo,publicPartnerRoute:po,publicSourcesRoute:co,publicCategoriesSlugRoute:Ro,publicEntreprisesSlugRoute:vo},jo=h._addFileChildren(zo)._addFileTypes(),Y=new je;function Oo(){return nt(Le({routeTree:jo,context:{queryClient:Y},scrollRestoration:!0}),Y)}const gn=Ye({createRouter:Oo,getRouterManifest:dt})(it);export{Br as A,be as B,Tt as C,ve as D,Jr as E,Re as F,we as G,$e as H,x as I,Ce as J,xe as K,gt as L,Yr as M,hn as N,gn as O,At as P,se as R,Pt as a,zt as b,I as c,jt as d,Et as e,It as f,kt as g,J as h,Ft as i,Lt as j,b as k,pr as l,ur as m,xt as n,ue as o,un as p,mn as q,ge as r,dn as s,Q as t,Nt as u,fe as v,te as w,_e as x,H as y,ye as z};
