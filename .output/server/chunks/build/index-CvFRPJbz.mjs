import{bc as e,at as s,aV as r,t,r as n,j as a,L as o,aW as i,M as l}from"../nitro/nitro.mjs";import{l as d}from"./company-logo-B5lxhvXb.mjs";import{l as c}from"./plus-BVAK8_Jr.mjs";import{m,D as p,g as x,p as u,d as h,f as g}from"./dialog-D12vissF.mjs";import{p as j,d as y}from"./constantes-BPJ6_ssB.mjs";import"node:net";import"node:stream";import"node:events";import"node:process";import"node:buffer";import"node:timers";import"node:async_hooks";import"node:url";import"node:stream/web";import"node:crypto";import"./close--xrcrNXd.mjs";function O(){return a.jsx("article",{className:"border border-gray-300 p-5 rounded-sm",children:a.jsxs(o,{to:"/compte/entreprises/create",className:"text-sm border px-2 py-1 rounded-sm flex items-center gap-1.5 max-w-fit",children:[a.jsx(c,{className:"size-4"}),"Créer une entreprise"]})})}const pe=function(){var c,b;const f=e.useRouteContext(),N=s(r(f.user.id)),{mutate:v,isPending:w}=t({mutationFn:j}),[C,S]=n.useState(!1),[V,_]=n.useState(null);function g$1(e){e.preventDefault();const s=new FormData(e.target);v({data:{companyId:s.get("companyId"),companySlug:s.get("companySlug")}},{onSuccess:()=>{f.queryClient.invalidateQueries({queryKey:["user","companies"]}),f.queryClient.invalidateQueries({queryKey:["company",V]}),S(!1),l.success("Entreprise supprimée avec succès")},onError:()=>{l.error("Une erreur est survenue lors de la suppression de l'entreprise")}})}return(null==(c=N.data)?void 0:c.length)?a.jsxs("div",{className:"container px-4 py-6",children:[a.jsxs("header",{className:"mb-6",children:[a.jsx("h1",{className:"text-2xl font-bold",children:"Mes entreprises"}),a.jsx("p",{children:"Gérez vos entreprises et leurs informations."})]}),a.jsx("ul",{className:"flex flex-col gap-2 ",children:null==(b=N.data)?void 0:b.map((e=>{var s;return a.jsx("li",{children:a.jsxs("article",{className:"border border-gray-300 p-5 rounded-sm grid gap-4 shadow-2xs",children:[a.jsxs("header",{className:"flex items-baseline gap-2 justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(d,{name:e.name,url:null==(s=e.logo)?void 0:s.secureUrl}),a.jsx("h2",{className:"text-lg font-bold leading-1",children:e.name}),a.jsx("p",{className:"text-xs text-orange-300",children:y[e.status]})]}),a.jsx("p",{className:"text-xs text-gray-500 border px-2 py-1 rounded-sm inline-flex gap-2 items-center hover:cursor-pointer ",children:e.siret})]}),a.jsxs("footer",{className:"flex items-center gap-2 justify-between",children:[a.jsx("ul",{className:"flex flex-wrap gap-2",children:e.categories.map((e=>a.jsx("li",{className:"bg-gray-100 px-2 py-1 rounded-sm text-xs flex items-center gap-2",children:e.category_name},e.category_id)))}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(o,{to:"/entreprises/$slug",params:{slug:e.slug},className:"text-xs px-2 py-1 rounded-sm border border-blue-400 text-blue-400",children:"Consulter"}),a.jsx(o,{to:"/compte/entreprises/$slug/edit/infos",params:{slug:e.slug},className:"text-xs px-2 py-1 rounded-sm border border-blue-400 text-blue-400",children:"Modifier"}),a.jsxs(m,{open:C&&V===e.id,onOpenChange:S,children:[a.jsx(p,{asChild:!0,children:a.jsx("button",{type:"button",className:"text-xs px-2 py-1 rounded-sm border border-red-400 text-red-400 hover:bg-red-400 hover:text-white transition-colors",onClick:()=>_(e.id),children:"Supprimer"})}),a.jsxs(x,{className:"grid gap-4",children:[a.jsx(u,{className:"text-lg font-bold",children:"Supprimer une entreprise"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs(h,{className:"text-sm text-gray-500",children:["Valider la suppression de l'entreprise ",a.jsx("strong",{children:e.name})," ?"]}),a.jsx("p",{className:"text-sm text-gray-500",children:"Cette action est irréversible. Toutes les données liées à cette entreprise seront perdues."})]}),a.jsxs("div",{className:"grid grid-flow-col gap-2 place-content-end",children:[a.jsx(g,{asChild:!0,children:a.jsx("button",{type:"button",className:"text-xs px-2 py-1 rounded-sm border border-gray-400 text-gray-400 hover:bg-gray-400 hover:text-white transition-colors",children:"Annuler"})}),a.jsxs("form",{onSubmit:g$1,children:[a.jsx("input",{type:"hidden",name:"companyId",value:e.id}),a.jsx("input",{type:"hidden",name:"companySlug",value:e.slug}),a.jsx("button",{type:"submit",className:"text-xs px-2 py-1 rounded-sm border border-red-400 text-red-400 hover:bg-red-400 hover:text-white transition-colors",children:w?"...":"Valider"})]})]})]})]})]})]})]})},e.id)}))}),N.data.length<3&&a.jsxs(a.Fragment,{children:[a.jsx(i,{className:"my-6 h-px bg-gray-300"}),a.jsx(O,{})]})]}):a.jsx("div",{className:"container px-4 py-6",children:a.jsxs("div",{className:"flex flex-col items-center justify-center gap-4",children:[a.jsx("h1",{className:"text-2xl font-bold",children:"Vous n'avez encore d'entreprise référencée"}),a.jsx(o,{to:"/compte/entreprises/create",className:"text-sm border px-2 py-1 rounded-sm",children:"Créer une entreprise"})]})})};export{pe as component};
//# sourceMappingURL=index-CvFRPJbz.mjs.map
