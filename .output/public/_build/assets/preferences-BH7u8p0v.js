import{r as i,j as e,D as ie,E as z,F as de,G as le,H as q,I as ce,J as U,K as ue,M as I,N as pe,Q as me,m as S,n as C,S as xe,T as fe,q as _,s as w,U as M,V as he,W as T,t as E}from"./client-0TpWmm9u.js";import{I as N}from"./input-B2F8Q8w2.js";import{L as R}from"./label-CmjesrgN.js";import{D as A,a as O,b as V,c as G}from"./dialog-DXHigXuk.js";import{R as b}from"./index-Dt2I4tfU.js";import"./close-BuE9jvDt.js";function ve(r){const s=i.useRef({value:r,previous:r});return i.useMemo(()=>(s.current.value!==r&&(s.current.previous=s.current.value,s.current.value=r),s.current.previous),[r])}var ge=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],k=ge.reduce((r,s)=>{const t=ie(`Primitive.${s}`),n=i.forwardRef((a,o)=>{const{asChild:d,...u}=a,p=d?t:s;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(p,{...u,ref:o})});return n.displayName=`Primitive.${s}`,{...r,[s]:n}},{}),D="Radio",[je,L]=q(D),[ye,be]=je(D),K=i.forwardRef((r,s)=>{const{__scopeRadio:t,name:n,checked:a=!1,required:o,disabled:d,value:u="on",onCheck:p,form:f,...h}=r,[x,v]=i.useState(null),l=U(s,j=>v(j)),c=i.useRef(!1),g=x?f||!!x.closest("form"):!0;return e.jsxs(ye,{scope:t,checked:a,disabled:d,children:[e.jsx(k.button,{type:"button",role:"radio","aria-checked":a,"data-state":Q(a),"data-disabled":d?"":void 0,disabled:d,value:u,...h,ref:l,onClick:I(r.onClick,j=>{a||p?.(),g&&(c.current=j.isPropagationStopped(),c.current||j.stopPropagation())})}),g&&e.jsx(H,{control:x,bubbles:!c.current,name:n,value:u,checked:a,required:o,disabled:d,form:f,style:{transform:"translateX(-100%)"}})]})});K.displayName=D;var B="RadioIndicator",$=i.forwardRef((r,s)=>{const{__scopeRadio:t,forceMount:n,...a}=r,o=be(B,t);return e.jsx(me,{present:n||o.checked,children:e.jsx(k.span,{"data-state":Q(o.checked),"data-disabled":o.disabled?"":void 0,...a,ref:s})})});$.displayName=B;var Ne="RadioBubbleInput",H=i.forwardRef(({__scopeRadio:r,control:s,checked:t,bubbles:n=!0,...a},o)=>{const d=i.useRef(null),u=U(d,o),p=ve(t),f=pe(s);return i.useEffect(()=>{const h=d.current;if(!h)return;const x=window.HTMLInputElement.prototype,l=Object.getOwnPropertyDescriptor(x,"checked").set;if(p!==t&&l){const c=new Event("click",{bubbles:n});l.call(h,t),h.dispatchEvent(c)}},[p,t,n]),e.jsx(k.input,{type:"radio","aria-hidden":!0,defaultChecked:t,...a,tabIndex:-1,ref:u,style:{...a.style,...f,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});H.displayName=Ne;function Q(r){return r?"checked":"unchecked"}var Re=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],P="RadioGroup",[_e,Be]=q(P,[z,L]),W=z(),J=L(),[we,Se]=_e(P),X=i.forwardRef((r,s)=>{const{__scopeRadioGroup:t,name:n,defaultValue:a,value:o,required:d=!1,disabled:u=!1,orientation:p,dir:f,loop:h=!0,onValueChange:x,...v}=r,l=W(t),c=de(f),[g,j]=le({prop:o,defaultProp:a??"",onChange:x,caller:P});return e.jsx(we,{scope:t,name:n,required:d,disabled:u,value:g,onValueChange:j,children:e.jsx(ce,{asChild:!0,...l,orientation:p,dir:c,loop:h,children:e.jsx(k.div,{role:"radiogroup","aria-required":d,"aria-orientation":p,"data-disabled":u?"":void 0,dir:c,...v,ref:s})})})});X.displayName=P;var Y="RadioGroupItem",Z=i.forwardRef((r,s)=>{const{__scopeRadioGroup:t,disabled:n,...a}=r,o=Se(Y,t),d=o.disabled||n,u=W(t),p=J(t),f=i.useRef(null),h=U(s,f),x=o.value===a.value,v=i.useRef(!1);return i.useEffect(()=>{const l=g=>{Re.includes(g.key)&&(v.current=!0)},c=()=>v.current=!1;return document.addEventListener("keydown",l),document.addEventListener("keyup",c),()=>{document.removeEventListener("keydown",l),document.removeEventListener("keyup",c)}},[]),e.jsx(ue,{asChild:!0,...u,focusable:!d,active:x,children:e.jsx(K,{disabled:d,required:o.required,checked:x,...p,...a,name:o.name,ref:h,onCheck:()=>o.onValueChange(a.value),onKeyDown:I(l=>{l.key==="Enter"&&l.preventDefault()}),onFocus:I(a.onFocus,()=>{v.current&&f.current?.click()})})})});Z.displayName=Y;var Ce="RadioGroupIndicator",ke=i.forwardRef((r,s)=>{const{__scopeRadioGroup:t,...n}=r,a=J(t);return e.jsx($,{...a,...n,ref:s})});ke.displayName=Ce;var Pe=X,F=Z;const Ee=C("app_lib_api_users_mutations_delete-user_ts--deleteUser_createServerFn_handler","/_server"),Fe=S({method:"POST"}).handler(Ee),Ie=C("app_lib_api_users_mutations_update-user-email_ts--updateUserEmailFn_createServerFn_handler","/_server"),Ue=S({method:"POST"}).handler(Ie),De=C("app_lib_api_users_mutations_update-user-infos_ts--updateUserInfos_createServerFn_handler","/_server"),Me=S({method:"POST"}).handler(De),Te=C("app_lib_api_users_mutations_update-user-password_ts--updateUserPasswordFn_createServerFn_handler","/_server"),Ae=S({method:"POST"}).handler(Te);function Oe({user:r}){if(!r)return null;const s=r.name?.split(" ").map(t=>t[0]).join("");return r.image?e.jsxs(M,{className:"size-16 rounded-full",children:[e.jsx(he,{src:r.image,alt:r.name,className:"size-full rounded-full"}),e.jsx(T,{className:"size-full leading-1",children:s})]}):e.jsx(M,{className:"size-16 rounded-full border border-gray-200 flex",children:e.jsx(T,{className:"size-full leading-1 text-2xl grid place-items-center text-blue-500",children:s})})}const $e=function(){const s=xe.useRouteContext(),[t,n]=i.useState(!1),[a,o]=i.useState(!1),{theme:d,onThemeLight:u,onThemeDark:p,onThemeSystem:f,setTheme:h}=fe(),{mutate:x,isPending:v}=_({mutationFn:w(Fe)}),{mutate:l,isPending:c}=_({mutationFn:w(Me)}),{mutate:g,isPending:j}=_({mutationFn:w(Ae)}),{mutate:ee,isPending:se}=_({mutationFn:w(Ue)});function re(){x({data:{userId:s.user.id}})}function te(m){m.preventDefault();const y=new FormData(m.currentTarget);l({data:y},{onSuccess:async()=>{await s.queryClient.invalidateQueries({queryKey:["user","session"],refetchType:"all"}),E.success("Nom et prénom modifié avec succès")}})}function ae(m){m.preventDefault();const y=new FormData(m.currentTarget);g({data:y},{onSuccess:()=>{o(!1),E.success("Mot de passe modifié avec succès")}})}function oe(m){m.preventDefault();const y=new FormData(m.currentTarget);ee({data:y},{onSuccess:()=>{E.success("Email modifié avec succès")}})}function ne(m){const y={light:u,dark:p,system:f};h(m),y[m]()}return e.jsxs("div",{className:"container px-4 py-6",children:[e.jsxs("header",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Préférences utilisateur"}),e.jsx("p",{children:"Modifiez vos préférences utilisateur pour personnaliser votre expérience sur le site."})]}),e.jsx(b,{className:"my-8 h-px bg-gray-300"}),e.jsxs("div",{className:"grid gap-8",children:[e.jsxs("article",{className:"border border-gray-300 p-4 rounded-sm flex justify-between",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Avatar"}),e.jsx("p",{className:"text-sm text-pretty",children:"Votre avatar est votre image de profil. Vous pouvez le modifier en cliquant sur l'avatar."})]}),e.jsx("div",{className:"flex justify-center px-4",children:e.jsx(Oe,{user:s.user})})]}),e.jsx("article",{className:"border border-gray-300 p-4 rounded-sm",children:e.jsxs("form",{onSubmit:te,children:[e.jsxs("div",{className:"flex flex-col gap-2 py-4",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Nom et prénom"}),e.jsx("p",{className:"text-sm text-pretty",children:"Votre nom et prénom sont utilisés pour identifier votre compte. Vous pouvez le modifier en cliquant sur le bouton ci-dessous."}),e.jsxs(R,{children:[e.jsx("span",{className:"sr-only",children:"Nom et prénom"}),e.jsx(N,{name:"name",defaultValue:s.user.name,className:"max-w-1/3 text-sm"})]})]}),e.jsx(b,{className:"my-4 -mx-4 h-px bg-gray-300"}),e.jsx("div",{className:"flex gap-2 justify-end",children:e.jsx("button",{type:"submit",className:"bg-gray-500 text-white px-4 py-2 rounded-sm text-xs",disabled:c,children:c?"Modification en cours...":"Modifier mon nom et prénom"})})]})}),e.jsx("article",{className:"border border-gray-300 p-4 rounded-sm",children:e.jsxs("form",{onSubmit:oe,children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Email"}),e.jsx("p",{className:"text-sm text-pretty",children:"Un email de confirmation vous sera envoyé afin de vérifier votre identité"}),e.jsxs(R,{children:[e.jsx("span",{className:"sr-only",children:"Email"}),e.jsx(N,{name:"email",defaultValue:s.user.email,className:"max-w-1/3 text-sm"})]})]}),e.jsx(b,{className:"my-4 -mx-4 h-px bg-gray-300"}),e.jsx("div",{className:"flex gap-2 justify-end",children:e.jsx("button",{type:"submit",className:"bg-gray-500 text-white px-4 py-2 rounded-sm text-xs",children:se?"Modification en cours...":"Modifier mon email"})})]})}),e.jsxs("article",{className:"border border-gray-300 p-4 rounded-sm",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Mot de passe"}),e.jsx("p",{className:"text-sm text-pretty",children:"Votre mot de passe est utilisé pour accéder à votre compte. Vous pouvez le modifier en cliquant sur le bouton ci-dessous."}),e.jsxs(R,{children:[e.jsx("span",{className:"sr-only",children:"Mot de passe"}),e.jsx(N,{type:"password",name:"password",defaultValue:"password",className:"max-w-1/3 text-sm"})]})]}),e.jsx(b,{className:"my-4 -mx-4 h-px bg-gray-300"}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx("button",{type:"button",className:"bg-gray-500 text-white px-4 py-2 rounded-sm text-xs",onClick:()=>o(!0),children:"Modifier mon mot de passe"}),e.jsx(A,{open:a,onOpenChange:o,children:e.jsxs(O,{children:[e.jsx(V,{children:"Modifier mon mot de passe"}),e.jsx(b,{className:"my-4 -mx-4 h-px bg-gray-300"}),e.jsx(G,{className:"mb-6",children:"Veuillez entrer votre mot de passe actuel et votre nouveau mot de passe."}),e.jsxs("form",{onSubmit:ae,children:[e.jsxs("div",{className:"flex flex-col gap-4 mb-4",children:[e.jsxs(R,{className:"flex flex-col gap-2",children:[e.jsx("span",{className:"text-sm",children:"Mot de passe actuel"}),e.jsx(N,{type:"password",name:"password",className:"text-sm"})]}),e.jsxs(R,{className:"flex flex-col gap-2",children:[e.jsx("span",{className:"text-sm",children:"Nouveau mot de passe"}),e.jsx(N,{type:"password",name:"newPassword",className:"text-sm"})]})]}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx("button",{type:"button",className:"bg-gray-500 text-white px-4 py-2 rounded-sm text-xs",onClick:()=>o(!1),children:"Annuler"}),e.jsx("button",{type:"submit",className:"bg-gray-500 text-white px-4 py-2 rounded-sm text-xs",children:j?"Modification en cours...":"Modifier mon mot de passe"})]})]})]})})]})]}),e.jsx("article",{className:"border border-gray-300 p-4 rounded-sm",children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Thème"}),e.jsx("p",{className:"text-sm text-pretty",children:"Vous pouvez modifier le thème de votre site en selectionnant une option ci-dessous."}),e.jsxs(Pe,{defaultValue:d??"system",onValueChange:m=>ne(m),className:"flex gap-2",children:[e.jsx(F,{value:"light",className:"bg-gray-500 text-white px-4 py-2 rounded-sm text-xs cursor-pointer dark:bg-gray-900 dark:text-white dark:border dark:border-gray-700",children:"Light"}),e.jsx(F,{value:"dark",className:"bg-gray-500 text-white px-4 py-2 rounded-sm text-xs cursor-pointer dark:bg-gray-900 dark:text-white dark:border dark:border-gray-700",children:"Dark"}),e.jsx(F,{value:"system",className:"bg-gray-500 text-white px-4 py-2 rounded-sm text-xs cursor-pointer dark:bg-gray-900 dark:text-white dark:border dark:border-gray-700",children:"System"})]})]})}),e.jsx(b,{className:"my-8 h-px bg-gray-300"}),e.jsxs("article",{className:"border border-red-500 rounded-sm flex flex-col gap-6",children:[e.jsxs("div",{className:"flex flex-col gap-2 p-4",children:[e.jsx("h2",{className:"text-lg font-bold",children:"Supprimer mon compte"}),e.jsx("p",{children:"Supprimer votre compte utilisateur et toutes vos données associées. Cette action est irréversible."})]}),e.jsxs("div",{className:"flex justify-end p-4 border-t border-red-500",children:[e.jsx("button",{type:"button",className:"bg-red-500 text-white px-4 py-2 rounded-sm text-sm",onClick:()=>n(!0),children:"Supprimer mon compte"}),e.jsx(A,{open:t,onOpenChange:n,children:e.jsxs(O,{children:[e.jsx(V,{children:"Supprimer mon compte"}),e.jsx(b,{className:"my-4 -mx-4 h-px bg-gray-300"}),e.jsx(G,{className:"mb-6",children:"Si vous souhaitez supprimer votre compte, veuillez cliquer sur le bouton ci-dessous."}),e.jsxs("div",{className:"flex justify-end gap-2 px-2",children:[e.jsx("button",{type:"button",className:"bg-gray-500 text-white px-4 py-2 rounded-sm text-xs",onClick:()=>n(!1),children:"Annuler"}),e.jsx("button",{type:"button",className:"bg-red-500 text-white px-4 py-2 rounded-sm text-xs",disabled:v,onClick:re,children:v?"Suppression en cours...":"Supprimer mon compte"})]})]})})]})]})]})]})};export{$e as component};
